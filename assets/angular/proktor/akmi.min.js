var d=new Date,versionApp="?"+RDM_version,TimeZoneDiv=TzDifference-d.getTimezoneOffset(),intervalPromise=null,reanalytic=60,RdmApp=angular.module("RdmApp",["ngCookies","ui.router","textAngular","ui.bootstrap","oc.lazyLoad","ngSanitize","ui.select2","datatables","angularFileUpload","infinite-scroll","ADM-dateTimePicker","datatables.buttons","chart.js"]);RdmApp.constant("ConstantAlias",{}),RdmApp.config(["$controllerProvider",function(e){}]),RdmApp.filter("trustThisUrl",["$sce",function(e){return function(a){return e.trustAsResourceUrl(a)}}]),RdmApp.config((function(){angular.lowercase=angular.$$lowercase})),RdmApp.config(["$ocLazyLoadProvider",function(e){e.config({})}]),RdmApp.run(["$rootScope","$location","$state","$http","$window","$cookies",function(e,a,t,n,o,r){e.$state=t,e.userData=r.get("userdata")||"",console.log(e.$state),e.$on("$stateChangeStart",(function(){jQuery.blockUI({})})),e.$on("$viewContentLoaded",(function(){try{jQuery.unblockUI({})}catch(e){}})),e.$on("$stateChangeSuccess",(function(){jQuery.blockUI({})})),e.$on("$stateNotFound",(function(){jQuery.unblockUI({})})),e.$on("$locationChangeStart",(function(a,t,n){$(".wrapper").hasClass("toggled")&&($(".wrapper").removeClass("toggled"),$(".sidebar-wrapper").unbind("hover")),setTimeout((function(){o.ga("create","UA-99897280-1","auto"),o.ga("send","pageview",window.location.href),$(".datepicker").hide()}),500),e.userData=r.get("akmiData")||"";var i=r.get("_revision")||"";""==e.userData?window.location.reload():(i!==RDM_version&&("serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then((function(e){for(let a of e)console.log(a),a.unregister()})),console.log("Clearing Workbox Cache."),caches.keys().then((e=>{e.forEach((e=>{console.log("deleting cache",e),caches.delete(e)}))})),Swal.fire({type:"warning",title:"Update",showConfirmButton:!1,html:"Terdapat pembaharuan aplikasi, aplikasi akan dimuat ulang",timer:3e3}).then((e=>{e.dismiss===Swal.DismissReason.timer&&window.location.reload()}))),e.userData=JSON.parse(e.userData))}))}]),RdmApp.controller("SidebarController",["$state","$scope",function(e,a){setTimeout((function(){handleSidebarMenuActiveLink("match",null,e)}),1e3),a.$on("$includeContentLoaded",(function(){Array.from(document.querySelectorAll(".c-sidebar")).forEach((function(e){Sidebar._sidebarInterface(e)}))}))}]),RdmApp.controller("rdmController",["$rootScope","$state","$interval","$scope","$cookies","$window","ApiServer",function(e,a,t,n,o,r,i){e.cekLogin=function(){""==(o.get("akmiData")||"")&&window.location.reload()},e.clearCacheWB=function(){"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then((function(e){for(let a of e)console.log(a),a.unregister()})),console.log("Clearing Workbox Cache."),caches.keys().then((e=>{e.forEach((e=>{console.log("deleting cache",e),caches.delete(e)}))})),Swal.fire({type:"warning",title:"Update",showConfirmButton:!1,html:"Clear cache aplikasi, silahkan ditunggu!!",timer:3e3}).then((e=>{e.dismiss===Swal.DismissReason.timer&&window.location.reload()}))},e.arrPush=function(e){var a={};return angular.forEach(e,(function(e,t){a[t]=e})),a},e.chpassword={},e.dochangePasswd=function(){$(".password-modal").modal("hide"),$.blockUI({}),i.post("proktor/ubahpassword",e.chpassword,(function(e){$.unblockUI({}),e.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Password berhasil diubah",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,html:e.message}).then((e=>{e.value&&($(".password-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},e.ubahPassword=function(){$(".password-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},e.customepdf=function(e,a,t){e.content.splice(0,1);var n=new Date,o=n.getDate()+"-"+(n.getMonth()+1)+"-"+n.getFullYear();e.pageMargins=[20,60,20,40],e.defaultStyle.fontSize=12,e.styles.tableHeader.fontSize=14,e.header=function(){return{columns:[{alignment:"left",italics:!0,text:a,fontSize:14,margin:[10,0]},{alignment:"right",fontSize:14,text:t}],margin:20}},e.footer=function(e,a){return{columns:[{alignment:"left",text:["Created on: ",{text:o.toString()}]},{alignment:"right",text:["page ",{text:e.toString()}," of ",{text:a.toString()}]}],margin:20}};var r={hLineWidth:function(e){return.5},vLineWidth:function(e){return.5},hLineColor:function(e){return"#aaa"},vLineColor:function(e){return"#aaa"},paddingLeft:function(e){return 8},paddingRight:function(e){return 4}};return e.content[0].layout=r,e},null==intervalPromise&&(intervalPromise=t((function(){(reanalytic-=1)<=0&&(reanalytic=60,r.ga("create","UA-99897280-1","auto"),r.ga("send","pageview",window.location.href))}),1e3));var s=0,l=setInterval((function(){!function(){s>100?s>=107&&(clearInterval(l),$(".pre-loader").hide()):(e=s,document.getElementById("bar1").style.width=e+"%",document.getElementById("percent1").innerHTML=e+"%");var e;s++}()}),10)}]),RdmApp.controller("proktor",["$rootScope","$state","$scope","ApiServer","$window",function(e,a,t,n,o){e.labels=[],e.dataChart=[],e.dashboard=[],e.infoRDM="",e.editInfo=!1,e.logAdmin={},e.masterpelaksana=[],e.dataServer={},e.dataPengawas=[],e.dataPenumpang=[],e.profile={},e.loaddatasiswa=!0,e.masterRuang=[],e.getdataserver=function(){n.get("proktor/server",(function(a){e.masterRuang=[],e.dataServer=a.data,e.dataKelas=a.kelas,angular.forEach(e.dataServer,(function(a,t){angular.forEach(a.ruangan,(function(e,t){this.push({ruangan_id:e.ruangan_id,server_ruang:a.server_kode+"/Ruang "+e.ruangan_nama})}),e.masterRuang)})),console.log(e.masterRuang),t.$broadcast("ProvChange",e.masterprov)}))},e.getdataserver(),e.getdatapengawas=function(){n.get("proktor/pengawas",(function(a){e.dataPengawas=a.data,t.$broadcast("ProvChange",e.masterprov)}))},e.getdatapengawas(),e.getdatapenumpang=function(){n.get("proktor/penumpang",(function(a){e.dataPenumpang=a.data,t.$broadcast("ProvChange",e.masterprov)}))},e.getdatapenumpang(),e.getdataprov=function(){n.get("proktor/pelaksana",(function(a){e.masterpelaksana=a.data,t.$broadcast("ProvChange",e.masterprov)}))},e.getdataprov(),e.getdatatingkat=function(){n.get("proktor/prov",(function(a){e.masterprov=a.data,t.$broadcast("ProvChange",e.masterprov)}))},e.getProfile=function(){n.get("proktor/profile",(function(a){e.profile=a.data,e.masterPeriode=a.periode,e.pelaksana=e.arrPush(a.data.pelaksana),t.$broadcast("ProfileChange",e.profile),setTimeout((function(){o.ga("create","UA-99897280-1","auto"),o.ga("send","pageview",window.location.href),$(".datepicker").hide()}),500)}))},e.getProfile()}]);
angular.module("RdmApp").directive("highMap",(function(t){return{restrict:"EAC",template:"<div></div>",replace:!0,controller:"main",scope:{widget:"="},link:function(t,e,n){var i=function(){var e=angular.extend(!0,{},{chart:{renderTo:"container"}},t.widget);new Highcharts.Map(e)};i(),t.$watch("widget",(function(t){i()}))}}})),RdmApp.directive("select2",["$timeout","$parse",function(t,e){return{restrict:"A",scope:{selectWidth:"@",ngModel:"=",ngDisabled:"="},link:function(e,n,i){e.selectWidth="100%",n.select2({theme:"bootstrap4",width:e.selectWidth,height:33,disabled:e.ngDisabled}),e.$watch("ngModel",(function(i){n.select2Initialized&&n.select2("destroy"),t((function(){console.log("Select 2 Recreate"),n.select2({theme:"bootstrap4",width:e.selectWidth,height:33,disabled:e.ngDisabled})}),100)}))}}}]),RdmApp.directive("chartjs",[function(){return{restrict:"E",template:"<canvas></canvas>",scope:{chartObject:"=value"},link:function(t,e,n){var i,c,r,o,a=function(t){e.empty(),e.append("<canvas></canvas>"),i=e.find("canvas")[0],c=i.getContext("2d"),o={type:t||"Line",width:n.width||600,height:n.height||400,last_type:!1},i.height=o.height,i.width=o.width,r=new Chart(c)};a(n.type),t.$watch((function(){return e.attr("type")}),(function(e){if(e){a(e);var n=o.type;void 0!==t.chartObject&&(r[n]=(t.chartObject.data,t.chartObject.options)),r[n]=(t.chartObject.data,t.chartObject.options)}})),t.$watch((function(){return t.chartObject}),(function(e){if(e){console.log(t.chartObject);var n=t.chartObject.type;r[n]=(t.chartObject.data,t.chartObject.options),t.chartInstance&&t.chartInstance.destroy(),t.chartInstance=r[n]=(t.chartObject.data,t.chartObject.options)}}),!0)}}}]),RdmApp.directive("ngBindHtmlUnsafe",[function(){return function(t,e,n){e.addClass("ng-binding").data("$binding",n.ngBindHtmlUnsafe),t.$watch(n.ngBindHtmlUnsafe,(function(t){"0"==t?e.html("0"):e.html(t||"")}))}}]),RdmApp.directive("bDatepicker",(function(){return{restrict:"A",require:"ngModel",scope:{ngModel:"=",minDate:"=",maxDate:"="},link:function(t,e,n,i){var c={format:"yyyy-mm-dd",autoclose:!0,onSelect:function(e){!function(e){console.log(e),""!==e&&t.$apply((function(){i.$setViewValue(e)}))}(e),this.focus()},onClose:function(t){this.blur()}};t.$watch("maxDate",(function(t,n){$(e).datepicker("option","endDate",t)})),t.$watch("minDate",(function(t,n){$(e).datepicker("option","startDate",t),$(e).datepicker("option","defaultDate",t)})),t.$watch("ngModel",(function(t){e.datepicker("setDate",new Date(t))})),e.datepicker(c)}}})),RdmApp.directive("timeAgo",["timeAgo","nowTime",function(t,e){return{restrict:"EA",link:function(n,i,c){var r;c.$observe("fromTime",(function(e){r=t.parse(e)})),n.$watch((function(){return e()-r}),(function(e){$(i).text(t.inWords(e))}))}}}]),RdmApp.directive("whenScrolled",(function(){return{restrict:"A",link:function(t,e,n){raw=e[0],console.log(e),e.bind("scroll",(function(){console.log("scroll"),raw.scrollTop+raw.offsetHeight+5>=raw.scrollHeight&&(t.loading=!0,t.$apply(n.whenScrolled))}))}}})),RdmApp.factory("httpPostFactory",["$http",function(t){return function(e,n,i){t({url:e,method:"POST",data:n,headers:{"Content-Type":void 0}}).success((function(t){i(t)}))}}]),RdmApp.directive("bnLazySrc",["$window","$document",function(t,e){var n=function(){var n=[],i=null,c=$(t),r=e,o=r.height(),a=null,l=!1;function s(){if(!i){var t=r.height();t!==o&&(o=t,h())}}function u(){console.log("Checking for visible images...");for(var t=[],e=[],i=c.height(),r=c.scrollTop(),o=r+i,a=0;a<n.length;a++){var l=n[a];l.isVisible(r,o)?t.push(l):e.push(l)}for(a=0;a<t.length;a++)t[a].render();n=e,d(),n.length||f()}function d(){clearTimeout(i),i=null}function h(){i=setTimeout(u,100)}function f(){l=!1,c.off("resize.bnLazySrc"),c.off("scroll.bnLazySrc"),clearInterval(a)}function p(){i||h()}return{addImage:function(t){n.push(t),i||h(),l||(l=!0,c.on("resize.bnLazySrc",p),c.on("scroll.bnLazySrc",p),a=setInterval(s,2e3))},removeImage:function(t){for(var e=0;e<n.length;e++)if(n[e]===t){n.splice(e,1);break}n.length||(d(),f())}}}();function i(t){var e=null,n=!1,i=null;function c(){t[0].src=e}return{isVisible:function(e,n){if(!t.is(":visible"))return!1;null===i&&(i=t.height());var c=t.offset().top,r=c+i;return c<=n&&c>=e||r<=n&&r>=e||c<=e&&r>=n},render:function(){n=!0,c()},setSource:function(t){e=t,n&&c()}}}return{link:function(t,e,c){var r=new i(e);n.addImage(r),c.$observe("bnLazySrc",(function(t){r.setSource(t)})),t.$on("$destroy",(function(){n.removeImage(r)}))},restrict:"A"}}]);
angular.module("RdmApp").factory("ApiServer",["$http","$rootScope","$timeout",function(e,n,t){var r={get:function(e,r){n.cekLogin(),$.post(e).done((function(e,n,a){"application/json"==(a.getResponseHeader("content-type")||"")?t((function(){r(e)}),1e3):r({success:!1,message:"Terdapat kesalahan pada server."})})).fail((function(e,n,t,a){Swal.fire({type:"error",title:"Gagal menyimpan",text:"Koneksi keserver gagal",showConfirmButton:!1,timer:1500}),r({success:!1,message:"Gagal menghubungi server."})}))},post:function(e,r,a){n.cekLogin(),$.post(e,r).done((function(e,n,r){"application/json"==(r.getResponseHeader("content-type")||"")?t((function(){a(e)}),1e3):a({success:!1,message:"Terdapat kesalahan pada server."})})).fail((function(e,n,t,r){Swal.fire({type:"error",title:"Gagal menyimpan",text:"Koneksi keserver gagal",showConfirmButton:!1,timer:1500}),a({success:!1,message:"Gagal menghubungi server."})}))}};return r}]),RdmApp.factory("common",["$http","$rootScope","$timeout",function(e,n,t){var r={get:function(e,r){n.cekLogin(),$.post(e).success((function(e,n,a){"application/json"==(a.getResponseHeader("content-type")||"")?t((function(){r(e)}),1e3):r({success:!1,message:"Terdapat kesalahan pada server."})})).error((function(e,n,t,a){Swal.fire({type:"error",title:"Gagal menyimpan",text:"Koneksi keserver gagal",showConfirmButton:!1,timer:1500}),r({success:!1,message:"Gagal menghubungi server."})}))},post:function(e,r,a){n.cekLogin(),$.post(e,r).success((function(e,n,r){"application/json"==(r.getResponseHeader("content-type")||"")?t((function(){a(e)}),1e3):a({success:!1,message:"Terdapat kesalahan pada server."})})).error((function(e,n,t,r){Swal.fire({type:"error",title:"Gagal menyimpan",text:"Koneksi keserver gagal",showConfirmButton:!1,timer:1500}),a({success:!1,message:"Gagal menghubungi server."})}))}};return r}]),RdmApp.factory("nowTime",["$timeout",function(e){var n=Date.now()-6e4*TimeZoneDiv;console.log(n);var t=function(){e((function(){n=Date.now()-6e4*TimeZoneDiv,t()}),3e4)};return t(),function(){return n}}]),RdmApp.factory("timeAgo",["$timeout",function(e){var n={settings:{refreshMillis:6e4,allowFuture:!1,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"lalu",suffixFromNow:"dari sekarang",seconds:"baru saja",minute:"semenit",minutes:"%d menit",hour:"Sejam",hours:"%d jam",day:"sehari",days:"%d hari",month:"sebulan",months:"%d bulan",year:"setahun",years:"%d tahun",numbers:[]}},inWords:function(e){var t=n.settings.strings,r=t.prefixAgo,a=t.suffixAgo;n.settings.allowFuture&&e<0&&(r=t.prefixFromNow,a=t.suffixFromNow);var o=Math.abs(e)/1e3,s=o/60,i=s/60,u=i/24,c=u/365;function m(n,r){var a=$.isFunction(n)?n(r,e):n,o=t.numbers&&t.numbers[r]||r;return a.replace(/%d/i,o)}var p=o<45&&m(t.seconds,Math.round(o))||o<90&&m(t.minute,1)||s<45&&m(t.minutes,Math.round(s))||s<90&&m(t.hour,1)||i<24&&m(t.hours,Math.round(i))||i<42&&m(t.day,1)||u<30&&m(t.days,Math.round(u))||u<45&&m(t.month,1)||u<365&&m(t.months,Math.round(u/30))||c<1.5&&m(t.year,1)||m(t.years,Math.round(c)),g=void 0===t.wordSeparator?" ":t.wordSeparator;return o<45?$.trim([r,p,""].join(g)):$.trim([r,p,a].join(g))},parse:function(e){if(angular.isNumber(e))return parseInt(e,10);var n=$.trim(e);return n=(n=(n=(n=n.replace(/\.\d+/,"")).replace(/-/,"/").replace(/-/,"/")).replace(/T/," ").replace(/Z/," UTC")).replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),new Date(n)}};return n}]);
angular.module("RdmApp").filter("html",["$sce",function(t){return t.trustAsHtml}]);
angular.module("RdmApp").config(["$stateProvider","$urlRouterProvider",function(a,e){e.otherwise("/dashboard"),a.state("dashboard",{url:"/dashboard",templateUrl:"default.html",data:{pageTitle:"Beranda PDAKMI",pageThumb:"Home",pageSubThumb:{0:"Beranda"}},controller:"DashboardCtrl"}).state("lembaga",{url:"/lembaga",templateUrl:"lembaga.html",data:{pageTitle:"Data Lembaga",pageThumb:"Home",pageSubThumb:{0:""}},controller:"lembagaCtrl"}).state("datasiswa",{url:"/datasiswa",templateUrl:"datasiswa.html",data:{pageTitle:"Data Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"datasiswaCtrl"}).state("server",{url:"/server",templateUrl:"server.html",data:{pageTitle:"Data Server",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"serverCtrl"}).state("sesi",{url:"/sesi",templateUrl:"sesi.html",data:{pageTitle:"Data Sesi",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"sesiCtrl"}).state("pengawas",{url:"/pengawas",templateUrl:"pengawas.html",data:{pageTitle:"Data Pengawas",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"pengawasCtrl"}).state("cetakkartu",{url:"/cetakkartu",templateUrl:"cetakkartu.html",data:{pageTitle:"Cetak Kartu",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"cetakkartuCtrl"}).state("cetakabsen",{url:"/cetakabsen",templateUrl:"cetakabsen.html",data:{pageTitle:"Cetak Absen",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"cetakabsenCtrl"}).state("kelengkapan",{url:"/kelengkapan",templateUrl:"kelengkapan.html",data:{pageTitle:"Chek kelengkapan",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"kelengkapanCtrl"}).state("timmadrasah",{url:"/timmadrasah",templateUrl:"timmadrasah.html",data:{pageTitle:"Chek kelengkapan",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"timmadrasahCtrl"})}]);
angular.module("RdmApp").controller("DashboardCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","$interval",function(t,a,o,e,n,i,s,r,l){var c;t.$on("$viewContentLoaded",(function(){try{l.cancel(c)}catch(t){}c=l((function(){"DashboardCtrl"==a.$state.$current.self.controller?t.getdashboard():(console.log("Not Dashboard"),l.cancel(c))}),3e5)})),t.doEditInfo=function(){a.editInfo=!0},t.saveInfo=function(){$.blockUI({}),r.post("proktor/saveInfo",a.infoRDM,(function(t){$.unblockUI({}),t.success?(a.getdashboard(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})}))},t.getdashboard=function(){a.logproktor={},r.get("proktor/dashboard",(function(o){o.success&&(a.dashboard=o.data,a.logproktor=o.log,a.infoRDM=o.info,a.editRDM=o.edit,t.getchart())}))},t.getchart=function(){r.get("proktor/getchart",(function(o){o.success&&(t.chartdata=[],t.labels=[],t.data=[],angular.forEach(o.data,(function(a,o){t.labels.push(o),t.chartdata.push(a)})),t.data.push(t.chartdata),a.dataChart=t.data,a.labelsChart=t.labels)}))},t.labels=a.labelsChart,t.series=["Rekap Aktivitas"],t.data=a.dataChart,t.onClick=function(t,a){console.log(t,a)},t.datasetOverride=[{yAxisID:"y-axis-1"}],t.options={scales:{yAxes:[{id:"y-axis-1",type:"linear",display:!0,position:"left"}]}},t.dtInstance={},t.getdashboard(),t.DashdtOptions=e.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("retrieve",!0).withOption("paging",!0).withOption("processing",!0).withPaginationType("full_numbers")}]);
angular.module("RdmApp").controller("cetakabsenCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$compile",function(t,a,e,r,l,s,u,c,n,k){t.selectRuang={},t.cetakkartuCtrl={},t.cetakkartuCtrl.show=!0,t.cetakkartuCtrl.url="",t.cetakkartuCtrl.message="",t.loadCetak=function(){$("#cetakKartu").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),localStorage.setItem("selectRuang",JSON.stringify(t.selectRuang)),""==t.selectRuang.tingkat_id?($("#cetakKartu").unblock({}),t.cetakkartuCtrl.show=!1,t.cetakkartuCtrl.url="",t.cetakkartuCtrl.message="Pilih Periode terlebih dahulu"):""==t.selectRuang.siswa_ruang?($("#cetakKartu").unblock({}),t.cetakkartuCtrl.show=!1,t.cetakkartuCtrl.url="",t.cetakkartuCtrl.message="Pilih Ruangan terlebih dahulu"):""==t.selectRuang.siswa_sesi?($("#cetakKartu").unblock({}),t.cetakkartuCtrl.show=!1,t.cetakkartuCtrl.url="",t.cetakkartuCtrl.message="Pilih Sesi terlebih dahulu"):(t.cetakkartuCtrl.show=!0,t.cetakkartuCtrl.url=base_url+"proktor/cetakabsen/"+t.selectRuang.tingkat_id+"/"+t.selectRuang.siswa_ruang+"/"+t.selectRuang.siswa_sesi,t.cetakkartuCtrl.message="",$("#cetakKartu").contents().find("html").html('<div class="spinner-border" role="status"><span class="sr-only">Loading...</span></div>'),$("#cetakKartu").load((function(){$("#cetakKartu").unblock({})})),$("#cetakKartu").bind("error",(function(){$("#cetakKartu").unblock({})}))),console.log(t.cetakkartuCtrl)},t.docetakKartu=function(){var t=window.frames.cetakKartu;t.focus(),t.print()},t.selectRuang={},t.selectRuang.tingkat_id="",t.selectRuang.siswa_ruang="",t.selectRuang.siswa_sesi="";try{t.selectRuang=JSON.parse(localStorage.getItem("selectRuang")||{}),t.selectRuang.tingkat_id="",t.loadCetak()}catch(t){}}]);
angular.module("RdmApp").controller("cetakkartuCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$compile",function(t,a,e,r,l,u,s,c,k,n){t.selectRuang={},t.cetakkartuCtrl={},t.cetakkartuCtrl.show=!0,t.cetakkartuCtrl.url="",t.cetakkartuCtrl.message="",t.loadCetak=function(){$("#cetakKartu").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),localStorage.setItem("selectRuang",JSON.stringify(t.selectRuang)),""==t.selectRuang.tingkat_id?($("#cetakKartu").unblock({}),t.cetakkartuCtrl.show=!1,t.cetakkartuCtrl.url="",t.cetakkartuCtrl.message="Pilih Periode terlebih dahulu"):""==t.selectRuang.siswa_ruang?($("#cetakKartu").unblock({}),t.cetakkartuCtrl.show=!1,t.cetakkartuCtrl.url="",t.cetakkartuCtrl.message="Pilih Ruangan terlebih dahulu"):""==t.selectRuang.siswa_sesi?($("#cetakKartu").unblock({}),t.cetakkartuCtrl.show=!1,t.cetakkartuCtrl.url="",t.cetakkartuCtrl.message="Pilih Sesi terlebih dahulu"):(t.cetakkartuCtrl.show=!0,t.cetakkartuCtrl.url=base_url+"proktor/cetakkartu/"+t.selectRuang.tingkat_id+"/"+t.selectRuang.siswa_ruang+"/"+t.selectRuang.siswa_sesi,t.cetakkartuCtrl.message="",$("#cetakKartu").contents().find("html").html('<div class="spinner-border" role="status"><span class="sr-only">Loading...</span></div>'),$("#cetakKartu").load((function(){$("#cetakKartu").unblock({})})),$("#cetakKartu").bind("error",(function(){$("#cetakKartu").unblock({})}))),console.log(t.cetakkartuCtrl)},t.docetakKartu=function(){var t=window.frames.cetakKartu;t.focus(),t.print()},t.selectRuang={},t.selectRuang.tingkat_id="",t.selectRuang.siswa_ruang="",t.selectRuang.siswa_sesi="";try{t.selectRuang=JSON.parse(localStorage.getItem("selectRuang")||{}),t.selectRuang.tingkat_id="",t.loadCetak()}catch(t){}}]);
angular.module("RdmApp").controller("datasiswaCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$compile",function(t,a,e,i,n,o,s,l,r,c){t.dtInstance={},t.dtInstance2={},t.tabelData=[],t.currPg=0,t.currPg1=0,t.dtColumns=[n.newColumn("no").withTitle("#").notSortable(),n.newColumn("siswa_nopes").withTitle("Nomor Peserta"),n.newColumn("siswa_nisn").withTitle("NISN"),n.newColumn("siswa_nama").withTitle("Nama"),n.newColumn("siswa_tempat").withTitle("Tempat Lahir"),n.newColumn("siswa_tgllahir").withTitle("Tanggal Lahir"),n.newColumn("tingkat_id").withTitle("Tingkat").notSortable(),n.newColumn(null).withTitle("Aksi").notSortable().renderWith((function(t,a,e,i){return""}))],t.dtOptions=i.newOptions().withOption("ajax",(function(a,e,i){console.log(a),$(".table-responsive").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),l.post("proktor/siswa/data",a,(function(a){$(".table-responsive").unblock({}),t.tabelData=a.results.data,e({recordsTotal:a.results.recordsTotal,recordsFiltered:a.results.recordsFiltered,data:a.results.data})}))})).withDataProp("data").withDOM("lBfrtip").withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> PDF',download:"open",orientation:"landscape",pageSize:"A4",exportOptions:{columns:":visible",search:"applied",order:"applied"},titleAttr:"Print",customize:function(t){a.customepdf(t,"Data Lembaga","Pangkalan Data AKMI")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,1,2,3,4,5,6,7]},titleAttr:"Excel"}]).withOption("drawCallback",(function(a){if(t.currPg=0,a.aoData.length>0){var e=this.api().page.info();console.log(e),t.currPg=e}})).withOption("language",{paginate:{first:"<i class='fa fa-fast-backward'></i>",previous:"<i class='fa fa-step-backward'></i>",next:"<i class='fa fa-step-forward'></i>",last:"<i class='fa fa-fast-forward'></i>|"}}).withOption("responsive",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withOption("serverSide",!0).withOption("aaSorting",[0,"asc"]).withOption("createdRow",(function(a){c(angular.element(a).contents())(t)})).withPaginationType("simple_numbers"),t.dtOptions2=i.newOptions().withOption("searching",!0).withOption("drawCallback",(function(a){if(t.currPg2=0,a.aoData.length>0){var e=this.api().page.info();console.log(e),t.currPg2=e}})).withOption("responsive",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("paging",!0).withOption("stateSave",!0).withOption("processing",!0).withPaginationType("full_numbers"),t.doSyncEmis=function(){$.blockUI({message:"<h4>Chek tahun ajaran</h4>"}),l.get("proktor/siswa/chekTaEmis",(function(a){if($.unblockUI(),a.success){var e=a.Emis.id;t.newsync=0,t.processSyncSiswa(1,e)}else Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})}))},t.newsync=0,t.processSyncSiswa=function(a,e){$.blockUI({message:"<h4>Syncron Data Emis Halaman "+a+"</h4>"}),l.post("proktor/siswa/syncEmis",{page:a,ta:e},(function(a){$.unblockUI(),a.success?(t.newsync+=a.update.length,!1!==a.next?t.processSyncSiswa(a.next,e):(t.reloadTable(),Swal.fire({type:"success",title:"Berhasil Syncron",showConfirmButton:!1,html:t.newsync+" siswa emis berhasil di Syncron",timer:2e3}))):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})}))},a.dataselectLembaga={},t.reloadTable=function(){localStorage.setItem("selectData",JSON.stringify(t.selectData)),$("#aktifTable").DataTable().ajax.reload()},t.dodataEdit=function(e){t.dataEdit=a.arrPush(t.tabelData[e]),$(".edit-moda").modal("show")}}]);
angular.module("RdmApp").controller("kelengkapanCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$compile",function(a,e,t,s,i,n,l,o,r,c){a.dtInstance={},a.dtInstance2={},a.tabelData={},a.selectData={},a.selectData.lembaga_id="",a.allSelect=!1,a.currPg=0,a.currPg1=0,a.dtColumns=[i.newColumn("no").withTitle("#").notSortable(),i.newColumn("siswa_nisn").withTitle("NISN"),i.newColumn("siswa_nama").withTitle("Nama"),i.newColumn("siswa_nopes").withTitle("Nomor Peserta").renderWith((function(e,t,s,i){return null!==a.tabelData[i.row].siswa_nopes&&""!==a.tabelData[i.row].siswa_nopes?'<span class="text-success"><i class="c-icon fa fa-check "></i></span><span ng-hide="1">OK</span>':'<span class="text-danger"><i class="c-icon fa fa-close "></i></span><span ng-hide="1">-</span>'})),i.newColumn("siswa_periode").withTitle("Periode").renderWith((function(e,t,s,i){return null!==a.tabelData[i.row].siswa_periode&&""!==a.tabelData[i.row].siswa_periode?'<span class="text-success"><i class="c-icon fa fa-check "></i></span><span ng-hide="1">OK</span>':'<span class="text-danger"><i class="c-icon fa fa-close "></i></span><span ng-hide="1">-</span>'})),i.newColumn("siswa_ruang").withTitle("Ruang").renderWith((function(e,t,s,i){return null!==a.tabelData[i.row].siswa_ruang&&""!==a.tabelData[i.row].siswa_ruang?'<span class="text-success"><i class="c-icon fa fa-check "></i></span><span ng-hide="1">OK</span>':'<span class="text-danger"><i class="c-icon fa fa-close "></i></span><span ng-hide="1">-</span>'})),i.newColumn("siswa_sesi").withTitle("Sesi").renderWith((function(e,t,s,i){return null!==a.tabelData[i.row].siswa_sesi&&""!==a.tabelData[i.row].siswa_sesi?'<span class="text-success"><i class="c-icon fa fa-check "></i></span><span ng-hide="1">OK</span>':'<span class="text-danger"><i class="c-icon fa fa-close "></i></span><span ng-hide="1">-</span>'}))],a.dtOptions=s.newOptions().withOption("ajax",(function(e,t,s){console.log(e),$(".table-responsive").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),a.edited?($(".table-responsive").unblock({}),Swal.fire({type:"warning",title:"Simpan",showConfirmButton:!0,html:"Data belum disimpan"}),t({data:a.tabelData})):(e.lembaga_id=a.selectData.lembaga_id,o.post("proktor/siswa/data",e,(function(e){$(".table-responsive").unblock({}),a.tabelData=e.results.data,a.allSelect=!1,t({recordsTotal:e.results.recordsTotal,recordsFiltered:e.results.recordsFiltered,data:e.results.data})})))})).withDataProp("data").withDOM("lBfrtip").withOption("language",{paginate:{first:"<i class='fa fa-fast-backward'></i>",previous:"<i class='fa fa-step-backward'></i>",next:"<i class='fa fa-step-forward'></i>",last:"<i class='fa fa-fast-forward'></i>|"}}).withOption("searching",!0).withOption("stateSave",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> PDF',download:"open",orientation:"potrait",pageSize:"A4",exportOptions:{columns:":visible",search:"applied",order:"applied"},titleAttr:"Print",customize:function(a){e.customepdf(a,"Kelengkapan siswa","Pangkalan Data AKMI")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:":visible",search:"applied",order:"applied"},titleAttr:"Excel"}]).withOption("drawCallback",(function(e){if(a.currPg=0,e.aoData.length>0){var t=this.api().page.info();console.log(t),a.currPg=t}})).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("paging",!0).withOption("processing",!0).withOption("serverSide",!0).withOption("aaSorting",[0,"asc"]).withOption("createdRow",(function(e){c(angular.element(e).contents())(a)})).withPaginationType("simple_numbers"),a.edited=!1,a.selectAll=function(){a.allSelect=!a.allSelect,angular.forEach(a.tabelData,(function(e,t){console.log(a.tabelData[t].select),a.allSelect?e.select=1:e.select=0})),a.$apply()},a.saveSesiAll=function(){$(".edit-modal").modal("hide"),console.log(a.dataEdit),angular.forEach(a.tabelData,(function(e,t){1===e.select&&(e.siswa_ruang=a.dataEdit.siswa_ruang,e.siswa_sesi=a.dataEdit.siswa_sesi)})),a.saveCurrent()},a.selectChange=function(){a.edited=!0,console.log(a.tabelData)},a.saveCurrent=function(){console.log(a.tabelData);var t=e.arrPush(a.tabelData);$(".table-responsive").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),o.post("proktor/siswa/simpanSesi",t,(function(e){$(".table-responsive").unblock({}),e.success?(a.edited=!1,$("#aktifTable").DataTable().ajax.reload(null,!1),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data berhasil disimpan",timer:2e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))},a.newsync=0,a.processSyncSiswa=function(e,t){$.blockUI({message:"<h4>Syncron Data Emis Halaman "+e+"</h4>"}),o.post("proktor/siswa/syncEmis",{page:e,ta:t},(function(e){$.unblockUI(),e.success?(a.newsync+=e.update.length,!1!==e.next?a.processSyncSiswa(e.next,t):(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil Syncron",showConfirmButton:!1,html:a.newsync+" siswa emis berhasil di Syncron",timer:2e3}))):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))},a.rekapnonsesi=0,a.showRekap=function(e,t){$.blockUI({message:"<h4>Memuat rekap, silahkan tunggu</h4>"}),o.post("proktor/siswa/rekapsesi",{page:e,ta:t},(function(e){$.unblockUI(),e.success?(a.dataRekap=e.data,a.rekapnonsesi=e.nonsesi,$(".rekap-modal").modal("show")):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))},e.dataselectLembaga={},a.reloadTable=function(){$("#aktifTable").DataTable().ajax.reload()},a.dataEdit={},a.dataEdit.siswa_ruang="",a.dataEdit.siswa_sesi="",a.dodataEdit=function(a){$(".edit-modal").modal("show")}}]);
angular.module("RdmApp").controller("lembagaCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(e,o,l,a,t,r,i,s,n){e.saveeditlembaga=function(){$.blockUI({}),s.post("proktor/lembaga/savepelaksana",o.pelaksana,(function(e){console.log(e),$.unblockUI({}),e.success?(o.getProfile(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))}}]);
angular.module("RdmApp").controller("pengawasCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$compile",function(a,t,e,n,i,s,o,r,l,c){a.dtInstance={},a.currPg=0,a.currPg1=0,a.dtOptions=n.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> PDF',download:"open",orientation:"landscape",pageSize:"A4",exportOptions:{columns:":visible",search:"applied",order:"applied"},titleAttr:"Print",customize:function(e){t.customepdf(e,"Data Lembaga "+a.kab_nama,"Pangkalan Data AKMI")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:":visible",stripHtml:!1,rows:".printabled"},titleAttr:"Excel"}]).withOption("language",{paginate:{first:"<i class='fa fa-fast-backward'></i>",previous:"<i class='fa fa-step-backward'></i>",next:"<i class='fa fa-step-forward'></i>",last:"<i class='fa fa-fast-forward'></i>|"}}).withOption("drawCallback",(function(t){if(a.currPg=0,t.aoData.length>0){var e=this.api().page.info();console.log(e),a.currPg=e.start}})).withDOM("lBfrtip").withOption("paging",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("stateSave",!0).withOption("processing",!0).withPaginationType("full_numbers"),a.tambahRuangan=function(a){Swal.fire({title:"Tambah Ruangan!",text:"Masukkan nomor ruangan :",input:"number",inputValue:"",showCancelButton:!0}).then((e=>{console.log(e),e.value&&($.blockUI({message:"<h4>Harap bersabar...</h4>Sedang Proses Syncron"}),r.post("proktor/tambahruangan",{nomor_ruangan:e.value,server_id:a.server_id},(function(a){$.unblockUI({}),a.success?(t.getdataserver(),Swal.fire({type:"success",title:"Tambah Ruang",showConfirmButton:!1,html:"Syncron data lembaga berhasil",timer:1e3})):Swal.fire({type:"error",title:"Tambah Ruang",showConfirmButton:!0,html:a.message})})))}))},a.tambahServer=function(){$.blockUI({}),r.get("proktor/tambahserver",(function(a){$.unblockUI(),a.success?(t.getdataserver(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Server berhasil ditambahkan",timer:2e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})}))},a.newsync=0,a.processSyncSiswa=function(t,e){$.blockUI({message:"<h4>Syncron Data Emis Halaman "+t+"</h4>"}),r.post("proktor/siswa/syncEmis",{page:t,ta:e},(function(t){$.unblockUI(),t.success?(a.newsync+=t.update.length,!1!==t.next?a.processSyncSiswa(t.next,e):(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil Syncron",showConfirmButton:!1,html:a.newsync+" siswa emis berhasil di Syncron",timer:2e3}))):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})}))},t.dataselectLembaga={},a.reloadTable=function(){localStorage.setItem("selectData",JSON.stringify(a.selectData)),$("#aktifTable").DataTable().ajax.reload()},a.dodataEdit=function(e){a.dataEdit=t.arrPush(a.tabelData[e]),$(".edit-moda").modal("show")}}]);
angular.module("RdmApp").controller("serverCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$compile",function(t,e,a,n,i,o,r,s,l,c){t.dtInstance={},t.currPg=0,t.currPg1=0,t.dtOptions=n.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> PDF',download:"open",orientation:"landscape",pageSize:"A4",exportOptions:{columns:":visible",search:"applied",order:"applied"},titleAttr:"Print",customize:function(a){e.customepdf(a,"Data Lembaga "+t.kab_nama,"Pangkalan Data AKMI")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:":visible",stripHtml:!1,rows:".printabled"},titleAttr:"Excel"}]).withOption("drawCallback",(function(e){if(t.currPg=0,e.aoData.length>0){var a=this.api().page.info();console.log(a),t.currPg=a.start}})).withOption("language",{paginate:{first:"<i class='fa fa-fast-backward'></i>",previous:"<i class='fa fa-step-backward'></i>",next:"<i class='fa fa-step-forward'></i>",last:"<i class='fa fa-fast-forward'></i>|"}}).withDOM("lBfrtip").withOption("paging",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("stateSave",!0).withOption("processing",!0).withPaginationType("full_numbers"),t.tambahRuangan=function(t){Swal.fire({title:"Tambah Ruangan!",text:"Masukkan nomor ruangan :",input:"number",inputValue:"",showCancelButton:!0}).then((a=>{console.log(a),a.value&&($.blockUI({message:"<h4>Harap bersabar...</h4>Sedang Proses Syncron"}),s.post("proktor/tambahruangan",{nomor_ruangan:a.value,server_id:t.server_id},(function(t){$.unblockUI({}),t.success?(e.getdataserver(),e.getdatapengawas(),Swal.fire({type:"success",title:"Tambah Ruang",showConfirmButton:!1,html:"Syncron data lembaga berhasil",timer:1e3})):Swal.fire({type:"error",title:"Tambah Ruang",showConfirmButton:!0,html:t.message})})))}))},t.tambahServer=function(){$.blockUI({}),s.get("proktor/tambahserver",(function(t){$.unblockUI(),t.success?(e.getdataserver(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Server berhasil ditambahkan",timer:2e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})}))},e.dataselectLembaga={},t.hapusRuangan=function(t){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus ruangan "+t.ruangan_nama+"?"}).then((a=>{console.log(a),"cancel"!==a.dismiss&&($.blockUI({}),s.post("proktor/deleteruang",t,(function(t){console.log(t),$.unblockUI({}),t.success?(e.getdataserver(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})})))}))},t.deleteServer=function(t){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus server "+t.server_kode+"?"}).then((a=>{console.log(a),"cancel"!==a.dismiss&&($.blockUI({}),s.post("proktor/deleteserver",t,(function(t){console.log(t),$.unblockUI({}),t.success?(e.getdataserver(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})})))}))},t.reloadTable=function(){localStorage.setItem("selectData",JSON.stringify(t.selectData)),$("#aktifTable").DataTable().ajax.reload()},t.dodataEdit=function(a){t.dataEdit=e.arrPush(t.tabelData[a]),$(".edit-moda").modal("show")}}]);
angular.module("RdmApp").controller("sesiCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$compile",function(a,e,t,n,i,s,o,l,r,c){a.dtInstance={},a.dtInstance2={},a.tabelData={},a.selectData={},a.selectData.lembaga_id="",a.allSelect=!1,a.currPg=0,a.currPg1=0,a.dtColumns=[i.newColumn("no").withTitle("#").notSortable().renderWith((function(t,n,i,s){return"1"==e.profile.pendataan?'<input class="form-control" type="checkbox"  ng-model="tabelData['+s.row+'].select" ng-init="tabelData['+s.row+'].select==1" ng-true-value="1" ng-false-value="0">':a.tabelData[s.row].no})),i.newColumn("siswa_nopes").withTitle("Nomor Peserta"),i.newColumn("siswa_nisn").withTitle("NISN"),i.newColumn("siswa_nama").withTitle("Nama"),i.newColumn("siswa_periode").withTitle("Periode").renderWith((function(t,n,i,s){var o="";"1"==e.profile.pendataan?(o='<select style="min-width:150px" class="form-control" ng-change="selectChange()" ng-model="tabelData['+s.row+'].siswa_periode"><option value="">Plilh Periode</option>',o+='<option ng-repeat="ruang in masterPeriode" value="{{ruang.periode_id}}" ng-bind="ruang.periode_nama+\' (\'+ruang.periode_tanggal+\')\'">Sesi 1</option>',o+="</select>"):angular.forEach(e.masterPeriode,(function(e,t){a.tabelData[s.row].siswa_periode==e.periode_id&&(o=e.periode_nama+" ("+e.periode_tanggal+")")}));return o})),i.newColumn("siswa_ruang").withTitle("Ruang").renderWith((function(t,n,i,s){var o="";"1"==e.profile.pendataan?(o+='<select style="min-width:250px" class="form-control" ng-change="selectChange()" ng-model="tabelData['+s.row+'].siswa_ruang"><option value="">Please select</option>',o+='<option ng-repeat="ruang in masterRuang" value="{{ruang.ruangan_id}}" ng-bind="ruang.server_ruang">Sesi 1</option>',o+="</select>"):angular.forEach(e.masterRuang,(function(e,t){a.tabelData[s.row].siswa_ruang==e.ruangan_id&&(o=e.server_ruang)}));return o})),i.newColumn("siswa_sesi").withTitle("Sesi").renderWith((function(t,n,i,s){var o="";"1"==e.profile.pendataan?o+='<select style="min-width:100px" class="form-control" ng-change="selectChange()" ng-model="tabelData['+s.row+'].siswa_sesi"><option value="">Please select</option><option value="1">Sesi 1</option><option value="2">Sesi 2</option></select>':o=a.tabelData[s.row].siswa_sesi;return o}))],a.dtOptions=n.newOptions().withOption("ajax",(function(e,t,n){console.log(e),$(".table-responsive").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),a.edited?($(".table-responsive").unblock({}),Swal.fire({type:"warning",title:"Simpan",showConfirmButton:!0,html:"Data belum disimpan"}),t({data:a.tabelData})):(e.lembaga_id=a.selectData.lembaga_id,l.post("proktor/siswa/data",e,(function(e){$(".table-responsive").unblock({}),a.tabelData=e.results.data,a.allSelect=!1,t({recordsTotal:e.results.recordsTotal,recordsFiltered:e.results.recordsFiltered,data:e.results.data})})))})).withDataProp("data").withDOM("lBfrtip").withOption("language",{paginate:{first:"<i class='fa fa-fast-backward'></i>",previous:"<i class='fa fa-step-backward'></i>",next:"<i class='fa fa-step-forward'></i>",last:"<i class='fa fa-fast-forward'></i>|"}}).withOption("searching",!0).withOption("stateSave",!0).withButtons([{text:'<i class="fa fa-check"></i>&nbsp;Select All',action:function(e,t,n,i){a.selectAll()}},{text:'<i class="fa fa-edit"></i>&nbsp;Edit',action:function(e,t,n,i){a.dodataEdit()}},{text:'<i class="fa fa-save"></i>&nbsp;Simpan',action:function(e,t,n,i){a.saveCurrent()}},{text:'<i class="fa fa-table"></i>&nbsp;Rekap',action:function(e,t,n,i){a.showRekap()}}]).withOption("drawCallback",(function(e){if(a.currPg=0,e.aoData.length>0){var t=this.api().page.info();console.log(t),a.currPg=t}})).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("paging",!0).withOption("processing",!0).withOption("serverSide",!0).withOption("aaSorting",[0,"asc"]).withOption("createdRow",(function(e){c(angular.element(e).contents())(a)})).withPaginationType("simple_numbers"),a.edited=!1,a.selectAll=function(){"1"==e.profile.pendataan&&(a.allSelect=!a.allSelect,angular.forEach(a.tabelData,(function(e,t){console.log(a.tabelData[t].select),a.allSelect?e.select=1:e.select=0})),a.$apply())},a.saveSesiAll=function(){"1"==e.profile.pendataan&&($(".edit-modal").modal("hide"),console.log(a.dataEdit),angular.forEach(a.tabelData,(function(e,t){1===e.select&&(e.siswa_periode=a.dataEdit.siswa_periode,e.siswa_ruang=a.dataEdit.siswa_ruang,e.siswa_sesi=a.dataEdit.siswa_sesi)})),a.saveCurrent())},a.selectChange=function(){a.edited=!0,console.log(a.tabelData)},a.saveCurrent=function(){if("1"==e.profile.pendataan){console.log(a.tabelData);var t=e.arrPush(a.tabelData);$(".table-responsive").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),l.post("proktor/siswa/simpanSesi",t,(function(e){$(".table-responsive").unblock({}),e.success?(a.edited=!1,$("#aktifTable").DataTable().ajax.reload(null,!1),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data berhasil disimpan",timer:2e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))}},a.newsync=0,a.processSyncSiswa=function(e,t){$.blockUI({message:"<h4>Syncron Data Emis Halaman "+e+"</h4>"}),l.post("proktor/siswa/syncEmis",{page:e,ta:t},(function(e){$.unblockUI(),e.success?(a.newsync+=e.update.length,!1!==e.next?a.processSyncSiswa(e.next,t):(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil Syncron",showConfirmButton:!1,html:a.newsync+" siswa emis berhasil di Syncron",timer:2e3}))):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))},a.rekapnonsesi=0,a.showRekap=function(e,t){$.blockUI({message:"<h4>Memuat rekap, silahkan tunggu</h4>"}),l.post("proktor/siswa/rekapsesi",{page:e,ta:t},(function(e){$.unblockUI(),e.success?(a.dataRekap=e.data,a.rekapnonsesi=e.nonsesi,$(".rekap-modal").modal("show")):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))},e.dataselectLembaga={},a.reloadTable=function(){$("#aktifTable").DataTable().ajax.reload()},a.dataEdit={},a.dataEdit.siswa_ruang="",a.dataEdit.siswa_sesi="",a.dodataEdit=function(e){var t=!0;angular.forEach(a.tabelData,(function(a,e){1===a.select&&(t=!1)})),t?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!0,html:"Pilih siswa terlebih dahulu"}):$(".edit-modal").modal("show")}}]);
angular.module("RdmApp").controller("timmadrasahCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(t,a,e,i,o,n,s,l,r){t.dtInstance={},t.mergerData={},t.selectData={},t.selectData.prov_id="",t.currPg=0,t.dtOptions=i.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(t){a.customepdf(t,"Data Provinsi","Pangkalan Data AKMI")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("drawCallback",(function(a){if(t.currPg=0,a.aoData.length>0){var e=this.api().page.info();console.log(e),t.currPg=e.start}})).withOption("columnDefs",[{responsivePriority:1,targets:0},{responsivePriority:2,targets:-1}]).withOption("language",{paginate:{first:"<i class='fa fa-fast-backward'></i>",previous:"<i class='fa fa-step-backward'></i>",next:"<i class='fa fa-step-forward'></i>",last:"<i class='fa fa-fast-forward'></i>|"}}).withDOM("lBfrtip").withOption("responsive",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withOption("aaSorting",[0,"asc"]).withPaginationType("full_numbers"),a.dataTimeline={},t.reloadTable=function(){$(".table-responsive").block({}),l.get("proktor/pengguna/data",(function(t){$(".table-responsive").unblock({}),a.dataTimeline=t.data}))},t.reloadTable(),t.tambahTimeline=function(a){t.dataEdit={},t.dataEdit.edit=!1;try{t.$apply()}catch(t){}$(".edit-modal").modal("show")},t.dodataEdit=function(e){t.dataEdit=a.arrPush(e),t.dataEdit.edit=!0;try{t.$apply()}catch(t){}$(".edit-modal").modal("show")},a.updatedataprov=function(){$.blockUI({}),l.get("proktor/prov",(function(t){$.unblockUI({}),a.masterprov=t.data}))},t.saveeditprov=function(){$(".edit-modal").modal("hide"),$.blockUI({}),l.post("proktor/pengguna/save",t.dataEdit,(function(a){$.unblockUI({}),a.success?(t.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:a.message,timer:1e3}).then((t=>{t.dismiss===Swal.DismissReason.timer&&$(".edit-modal").modal("show")}))}))},t.dodataDelete=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((e=>{console.log(e),"cancel"!==e.dismiss&&($.blockUI({}),l.post("proktor/pengguna/delete",{timmadrasah_id:a},(function(a){console.log(a),$.unblockUI({}),a.success?(t.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:a.message,timer:1e3})})))}))}}]);
