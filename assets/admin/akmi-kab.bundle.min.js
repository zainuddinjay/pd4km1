var d=new Date,versionApp="?"+RDM_version,TimeZoneDiv=TzDifference-d.getTimezoneOffset(),intervalPromise=null,reanalytic=60,RdmApp=angular.module("RdmApp",["ngCookies","ui.router","textAngular","ui.bootstrap","oc.lazyLoad","ngSanitize","ui.select2","datatables","angularFileUpload","infinite-scroll","ADM-dateTimePicker","datatables.buttons","chart.js"]);RdmApp.constant("ConstantAlias",{}),RdmApp.config(["$controllerProvider",function(e){}]),RdmApp.config((function(){angular.lowercase=angular.$$lowercase})),RdmApp.config(["$ocLazyLoadProvider",function(e){e.config({})}]),RdmApp.run(["$rootScope","$location","$state","$http","$window","$cookies",function(e,t,a,n,o,r){e.$state=a,e.userData=r.get("userdata")||"",console.log(e.$state),e.$on("$stateChangeStart",(function(){jQuery.blockUI({})})),e.$on("$viewContentLoaded",(function(){try{jQuery.unblockUI({})}catch(e){}})),e.$on("$stateChangeSuccess",(function(){jQuery.blockUI({})})),e.$on("$stateNotFound",(function(){jQuery.unblockUI({})})),e.$on("$locationChangeStart",(function(t,a,n){$(".wrapper").hasClass("toggled")&&($(".wrapper").removeClass("toggled"),$(".sidebar-wrapper").unbind("hover")),setTimeout((function(){o.ga("create","UA-99897280-1","auto"),o.ga("send","pageview",window.location.href),$(".datepicker").hide()}),500),e.userData=r.get("akmiData")||"";var i=r.get("_revision")||"";""==e.userData?window.location.reload():(i!==RDM_version&&("serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then((function(e){for(let t of e)console.log(t),t.unregister()})),console.log("Clearing Workbox Cache."),caches.keys().then((e=>{e.forEach((e=>{console.log("deleting cache",e),caches.delete(e)}))})),Swal.fire({type:"warning",title:"Update",showConfirmButton:!1,html:"Terdapat pembaharuan aplikasi, aplikasi akan dimuat ulang",timer:3e3}).then((e=>{e.dismiss===Swal.DismissReason.timer&&window.location.reload()}))),e.userData=JSON.parse(e.userData))}))}]),RdmApp.controller("SidebarController",["$state","$scope",function(e,t){setTimeout((function(){handleSidebarMenuActiveLink("match",null,e)}),1e3),t.$on("$includeContentLoaded",(function(){Array.from(document.querySelectorAll(".c-sidebar")).forEach((function(e){Sidebar._sidebarInterface(e)}))}))}]),RdmApp.controller("rdmController",["$rootScope","$state","$interval","$scope","$cookies","$window","ApiServer",function(e,t,a,n,o,r,i){e.userData=JSON.parse(o.get("akmiData"))||{},e.cekLogin=function(){""==(o.get("akmiData")||"")&&window.location.reload()},e.clearCacheWB=function(){"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then((function(e){for(let t of e)console.log(t),t.unregister()})),console.log("Clearing Workbox Cache."),caches.keys().then((e=>{e.forEach((e=>{console.log("deleting cache",e),caches.delete(e)}))})),Swal.fire({type:"warning",title:"Update",showConfirmButton:!1,html:"Clear cache aplikasi, silahkan ditunggu!!",timer:3e3}).then((e=>{e.dismiss===Swal.DismissReason.timer&&window.location.reload()}))},e.arrPush=function(e){var t={};return angular.forEach(e,(function(e,a){t[a]=e})),t},e.chpassword={},e.dochangePasswd=function(){$(".password-modal").modal("hide"),$.blockUI({}),i.post("admin/ubahpassword",e.chpassword,(function(e){$.unblockUI({}),e.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Password berhasil diubah",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,html:e.message}).then((e=>{e.value&&($(".password-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},e.ubahPassword=function(){$(".password-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},e.customepdf=function(e,t,a){e.content.splice(0,1);var n=new Date,o=n.getDate()+"-"+(n.getMonth()+1)+"-"+n.getFullYear();e.pageMargins=[20,60,20,40],e.defaultStyle.fontSize=12,e.styles.tableHeader.fontSize=14,e.header=function(){return{columns:[{alignment:"left",italics:!0,text:t,fontSize:14,margin:[10,0]},{alignment:"right",fontSize:14,text:a}],margin:20}},e.footer=function(e,t){return{columns:[{alignment:"left",text:["Created on: ",{text:o.toString()}]},{alignment:"right",text:["page ",{text:e.toString()}," of ",{text:t.toString()}]}],margin:20}};var r={hLineWidth:function(e){return.5},vLineWidth:function(e){return.5},hLineColor:function(e){return"#aaa"},vLineColor:function(e){return"#aaa"},paddingLeft:function(e){return 8},paddingRight:function(e){return 4}};return e.content[0].layout=r,e},null==intervalPromise&&(intervalPromise=a((function(){(reanalytic-=1)<=0&&(reanalytic=60,r.ga("create","UA-99897280-1","auto"),r.ga("send","pageview",window.location.href))}),1e3));var l=0,c=setInterval((function(){!function(){l>100?l>=107&&(clearInterval(c),$(".pre-loader").hide()):(e=l,document.getElementById("bar1").style.width=e+"%",document.getElementById("percent1").innerHTML=e+"%");var e;l++}()}),10)}]),RdmApp.controller("admin",["$rootScope","$state","$scope","ApiServer","$window",function(e,t,a,n,o){e.datarekap={},e.labelsChart=[],e.dataChart=[],e.dashboard=[],e.infoRDM="",e.editInfo=!1,e.logAdmin={},e.masterprov=[],e.pengaturan={},e.profile={},e.loaddatasiswa=!0,e.getdataprov=function(){n.get("admin/prov",(function(t){e.masterprov=t.data,a.$broadcast("ProvChange",e.masterprov)}))},e.getdataprov(),e.getdatapengaturan=function(){n.get("admin/pengaturan/data",(function(t){e.pengaturan=t.data}))},console.log(e.userData.admin_dev),"1"==e.userData.admin_dev&&e.getdatapengaturan(),e.getProfile=function(){n.get("admin/profile",(function(t){e.profile=t.data,a.$broadcast("ProfileChange",e.profile),setTimeout((function(){o.ga("create","UA-99897280-1","auto"),o.ga("send","pageview",window.location.href),$(".datepicker").hide()}),500)}))},e.getProfile()}]);
angular.module("RdmApp").directive("highMap",(function(t){return{restrict:"EAC",template:"<div></div>",replace:!0,controller:"main",scope:{widget:"="},link:function(t,e,n){var i=function(){var e=angular.extend(!0,{},{chart:{renderTo:"container"}},t.widget);new Highcharts.Map(e)};i(),t.$watch("widget",(function(t){i()}))}}})),RdmApp.directive("select2",["$timeout","$parse",function(t,e){return{restrict:"A",scope:{selectWidth:"@",ngModel:"=",ngDisabled:"="},link:function(e,n,i){e.selectWidth="100%",n.select2({theme:"bootstrap4",width:e.selectWidth,height:33,disabled:e.ngDisabled}),e.$watch("ngModel",(function(i){n.select2Initialized&&n.select2("destroy"),t((function(){console.log("Select 2 Recreate"),n.select2({theme:"bootstrap4",width:e.selectWidth,height:33,disabled:e.ngDisabled})}),100)}))}}}]),RdmApp.directive("chartjs",[function(){return{restrict:"E",template:"<canvas></canvas>",scope:{chartObject:"=value"},link:function(t,e,n){var i,c,r,o,a=function(t){e.empty(),e.append("<canvas></canvas>"),i=e.find("canvas")[0],c=i.getContext("2d"),o={type:t||"Line",width:n.width||600,height:n.height||400,last_type:!1},i.height=o.height,i.width=o.width,r=new Chart(c)};a(n.type),t.$watch((function(){return e.attr("type")}),(function(e){if(e){a(e);var n=o.type;void 0!==t.chartObject&&(r[n]=(t.chartObject.data,t.chartObject.options)),r[n]=(t.chartObject.data,t.chartObject.options)}})),t.$watch((function(){return t.chartObject}),(function(e){if(e){console.log(t.chartObject);var n=t.chartObject.type;r[n]=(t.chartObject.data,t.chartObject.options),t.chartInstance&&t.chartInstance.destroy(),t.chartInstance=r[n]=(t.chartObject.data,t.chartObject.options)}}),!0)}}}]),RdmApp.directive("ngBindHtmlUnsafe",[function(){return function(t,e,n){e.addClass("ng-binding").data("$binding",n.ngBindHtmlUnsafe),t.$watch(n.ngBindHtmlUnsafe,(function(t){"0"==t?e.html("0"):e.html(t||"")}))}}]),RdmApp.directive("bDatepicker",(function(){return{restrict:"A",require:"ngModel",scope:{ngModel:"=",minDate:"=",maxDate:"="},link:function(t,e,n,i){var c={format:"yyyy-mm-dd",autoclose:!0,onSelect:function(e){!function(e){console.log(e),""!==e&&t.$apply((function(){i.$setViewValue(e)}))}(e),this.focus()},onClose:function(t){this.blur()}};t.$watch("maxDate",(function(t,n){$(e).datepicker("option","endDate",t)})),t.$watch("minDate",(function(t,n){$(e).datepicker("option","startDate",t),$(e).datepicker("option","defaultDate",t)})),t.$watch("ngModel",(function(t){e.datepicker("setDate",new Date(t))})),e.datepicker(c)}}})),RdmApp.directive("timeAgo",["timeAgo","nowTime",function(t,e){return{restrict:"EA",link:function(n,i,c){var r;c.$observe("fromTime",(function(e){r=t.parse(e)})),n.$watch((function(){return e()-r}),(function(e){$(i).text(t.inWords(e))}))}}}]),RdmApp.directive("whenScrolled",(function(){return{restrict:"A",link:function(t,e,n){raw=e[0],console.log(e),e.bind("scroll",(function(){console.log("scroll"),raw.scrollTop+raw.offsetHeight+5>=raw.scrollHeight&&(t.loading=!0,t.$apply(n.whenScrolled))}))}}})),RdmApp.factory("httpPostFactory",["$http",function(t){return function(e,n,i){t({url:e,method:"POST",data:n,headers:{"Content-Type":void 0}}).success((function(t){i(t)}))}}]),RdmApp.directive("bnLazySrc",["$window","$document",function(t,e){var n=function(){var n=[],i=null,c=$(t),r=e,o=r.height(),a=null,l=!1;function s(){if(!i){var t=r.height();t!==o&&(o=t,h())}}function u(){console.log("Checking for visible images...");for(var t=[],e=[],i=c.height(),r=c.scrollTop(),o=r+i,a=0;a<n.length;a++){var l=n[a];l.isVisible(r,o)?t.push(l):e.push(l)}for(a=0;a<t.length;a++)t[a].render();n=e,d(),n.length||f()}function d(){clearTimeout(i),i=null}function h(){i=setTimeout(u,100)}function f(){l=!1,c.off("resize.bnLazySrc"),c.off("scroll.bnLazySrc"),clearInterval(a)}function p(){i||h()}return{addImage:function(t){n.push(t),i||h(),l||(l=!0,c.on("resize.bnLazySrc",p),c.on("scroll.bnLazySrc",p),a=setInterval(s,2e3))},removeImage:function(t){for(var e=0;e<n.length;e++)if(n[e]===t){n.splice(e,1);break}n.length||(d(),f())}}}();function i(t){var e=null,n=!1,i=null;function c(){t[0].src=e}return{isVisible:function(e,n){if(!t.is(":visible"))return!1;null===i&&(i=t.height());var c=t.offset().top,r=c+i;return c<=n&&c>=e||r<=n&&r>=e||c<=e&&r>=n},render:function(){n=!0,c()},setSource:function(t){e=t,n&&c()}}}return{link:function(t,e,c){var r=new i(e);n.addImage(r),c.$observe("bnLazySrc",(function(t){r.setSource(t)})),t.$on("$destroy",(function(){n.removeImage(r)}))},restrict:"A"}}]);
angular.module("RdmApp").factory("ApiServer",["$http","$rootScope","$timeout",function(e,n,t){var r={get:function(e,r){n.cekLogin(),$.post(e).done((function(e,n,a){"application/json"==(a.getResponseHeader("content-type")||"")?t((function(){r(e)}),1e3):r({success:!1,message:"Terdapat kesalahan pada server."})})).fail((function(e,n,t,a){Swal.fire({type:"error",title:"Gagal menyimpan",text:"Koneksi keserver gagal",showConfirmButton:!1,timer:1500}),r({success:!1,message:"Gagal menghubungi server."})}))},post:function(e,r,a){n.cekLogin(),$.post(e,r).done((function(e,n,r){"application/json"==(r.getResponseHeader("content-type")||"")?t((function(){a(e)}),1e3):a({success:!1,message:"Terdapat kesalahan pada server."})})).fail((function(e,n,t,r){Swal.fire({type:"error",title:"Gagal menyimpan",text:"Koneksi keserver gagal",showConfirmButton:!1,timer:1500}),a({success:!1,message:"Gagal menghubungi server."})}))}};return r}]),RdmApp.factory("common",["$http","$rootScope","$timeout",function(e,n,t){var r={get:function(e,r){n.cekLogin(),$.post(e).success((function(e,n,a){"application/json"==(a.getResponseHeader("content-type")||"")?t((function(){r(e)}),1e3):r({success:!1,message:"Terdapat kesalahan pada server."})})).error((function(e,n,t,a){Swal.fire({type:"error",title:"Gagal menyimpan",text:"Koneksi keserver gagal",showConfirmButton:!1,timer:1500}),r({success:!1,message:"Gagal menghubungi server."})}))},post:function(e,r,a){n.cekLogin(),$.post(e,r).success((function(e,n,r){"application/json"==(r.getResponseHeader("content-type")||"")?t((function(){a(e)}),1e3):a({success:!1,message:"Terdapat kesalahan pada server."})})).error((function(e,n,t,r){Swal.fire({type:"error",title:"Gagal menyimpan",text:"Koneksi keserver gagal",showConfirmButton:!1,timer:1500}),a({success:!1,message:"Gagal menghubungi server."})}))}};return r}]),RdmApp.factory("nowTime",["$timeout",function(e){var n=Date.now()-6e4*TimeZoneDiv;console.log(n);var t=function(){e((function(){n=Date.now()-6e4*TimeZoneDiv,t()}),3e4)};return t(),function(){return n}}]),RdmApp.factory("timeAgo",["$timeout",function(e){var n={settings:{refreshMillis:6e4,allowFuture:!1,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"lalu",suffixFromNow:"dari sekarang",seconds:"baru saja",minute:"semenit",minutes:"%d menit",hour:"Sejam",hours:"%d jam",day:"sehari",days:"%d hari",month:"sebulan",months:"%d bulan",year:"setahun",years:"%d tahun",numbers:[]}},inWords:function(e){var t=n.settings.strings,r=t.prefixAgo,a=t.suffixAgo;n.settings.allowFuture&&e<0&&(r=t.prefixFromNow,a=t.suffixFromNow);var o=Math.abs(e)/1e3,s=o/60,i=s/60,u=i/24,c=u/365;function m(n,r){var a=$.isFunction(n)?n(r,e):n,o=t.numbers&&t.numbers[r]||r;return a.replace(/%d/i,o)}var p=o<45&&m(t.seconds,Math.round(o))||o<90&&m(t.minute,1)||s<45&&m(t.minutes,Math.round(s))||s<90&&m(t.hour,1)||i<24&&m(t.hours,Math.round(i))||i<42&&m(t.day,1)||u<30&&m(t.days,Math.round(u))||u<45&&m(t.month,1)||u<365&&m(t.months,Math.round(u/30))||c<1.5&&m(t.year,1)||m(t.years,Math.round(c)),g=void 0===t.wordSeparator?" ":t.wordSeparator;return o<45?$.trim([r,p,""].join(g)):$.trim([r,p,a].join(g))},parse:function(e){if(angular.isNumber(e))return parseInt(e,10);var n=$.trim(e);return n=(n=(n=(n=n.replace(/\.\d+/,"")).replace(/-/,"/").replace(/-/,"/")).replace(/T/," ").replace(/Z/," UTC")).replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),new Date(n)}};return n}]);
angular.module("RdmApp").filter("html",["$sce",function(t){return t.trustAsHtml}]);
angular.module("RdmApp").config(["$stateProvider","$urlRouterProvider",function(a,e){e.otherwise("/dashboard"),a.state("dashboard",{url:"/dashboard",templateUrl:"default.html",data:{pageTitle:"Beranda Elearning",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"DashboardCtrl"}).state("lembaga",{url:"/lembaga",templateUrl:"lembagakab.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"lembagaCtrl"}).state("carilembaga",{url:"/carilembaga",templateUrl:"admin/pages/carilembaga"+versionApp,data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"carilembagaCtrl",resolve:{deps:["$ocLazyLoad",function(a){return a.load({name:"RdmApp",insertBefore:"#ng_load_plugins_before",files:["assets/angular/js/controller/admin/carilembagaCtrl.js"+versionApp]})}]}}).state("pelaksanaan",{url:"/pelaksanaan",templateUrl:"pelaksanaan.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"pelaksanaCtrl"}).state("datasiswa",{url:"/datasiswa",templateUrl:"datasiswa.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"datasiswaCtrl"}).state("kecamatan",{url:"/kecamatan",templateUrl:"kecamatan.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"kecamatanCtrl"}).state("kelengkapan",{url:"/kelengkapan",templateUrl:"kelengkapan.html",data:{pageTitle:"Chek kelengkapan",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"kelengkapanCtrl"}).state("rekap",{url:"/rekap",templateUrl:"rekap.html",data:{pageTitle:"Pengaturan Aplikasi",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"rekapCtrl"})}]);
angular.module("RdmApp").controller("DashboardCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","$interval",function(t,a,e,o,n,i,s,r,l){var c;t.$on("$viewContentLoaded",(function(){try{l.cancel(c)}catch(t){}c=l((function(){"DashboardCtrl"==a.$state.$current.self.controller?t.getdashboard():(console.log("Not Dashboard"),l.cancel(c))}),3e5)})),t.doEditInfo=function(){a.editInfo=!0},t.saveInfo=function(){$.blockUI({}),r.post("admin/saveInfo",a.infoRDM,(function(t){$.unblockUI({}),t.success?(a.getdashboard(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})}))},t.getdashboard=function(){r.get("admin/dashboard",(function(e){e.success&&(a.dashboard=e.data,a.logAdmin=e.log,a.infoRDM=e.info,a.editRDM=e.edit,t.getchart())}))},t.getchart=function(){r.get("admin/getchart",(function(e){e.success&&(t.chartdata=[],t.labels=[],t.data=[],angular.forEach(e.data,(function(a,e){t.labels.push(e),t.chartdata.push(a)})),t.data.push(t.chartdata),a.dataChart=t.data,a.labelsChart=t.labels)}))},t.labels=a.labelsChart,t.series=["Rekap Aktivitas"],t.data=a.dataChart,t.onClick=function(t,a){console.log(t,a)},t.datasetOverride=[{yAxisID:"y-axis-1"}],t.options={scales:{yAxes:[{id:"y-axis-1",type:"linear",display:!0,position:"left"}]}},t.dtInstance={},t.getdashboard(),t.DashdtOptions=o.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("retrieve",!0).withOption("paging",!0).withOption("processing",!0).withPaginationType("full_numbers")}]);
angular.module("RdmApp").controller("adminkabCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(t,a,i,e,o,n,s,l,r){"adminkab"==a.userData.status&&(window.location.href="/"+a.userData.status),t.dtInstance={},t.dataEdit={},t.selectData={},t.selectData.prov_id="",t.currPg=0,t.dtOptions=e.newOptions().withOption("searching",!0).withOption("stateSave",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,4,3,1,2]},titleAttr:"Print",customize:function(t){a.customepdf(t,"Data Admin Provinsi","Pangkalan Data AKMI")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,4,3,1,2]},titleAttr:"Excel"}]).withOption("drawCallback",(function(a){if(t.currPg=0,a.aoData.length>0){var i=this.api().page.info();console.log(i),t.currPg=i.start}})).withOption("language",{paginate:{first:"<i class='fa fa-fast-backward'></i>",previous:"<i class='fa fa-step-backward'></i>",next:"<i class='fa fa-step-forward'></i>",last:"<i class='fa fa-fast-forward'></i>|"}}).withDOM("lBfrtip").withOption("responsive",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withOption("aaSorting",[0,"asc"]).withPaginationType("full_numbers"),a.dataadminprov=[],t.reloadTable=function(){a.readKab(),a.datalembaga=[],""!==t.selectData.prov_id&&($(".table-responsive").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),l.post("admin/adminkab/data",t.selectData,(function(t){$(".table-responsive").unblock({}),a.dataadminprov=t.data})))},a.readKab=function(){t.selectData.kab_id="",a.datakab=[],""!==t.selectData.prov_id&&l.post("admin/admin/kab",{prov_id:t.selectData.prov_id},(function(t){a.datakab=t.data}))},t.tambahData=function(){""==t.selectData.prov_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih provinsi terlebih dahulu",timer:1e3}):(t.dataEdit={},t.dataEdit.admin_prov=t.selectData.prov_id,t.dataEdit.edit=!1,$(".edit-modal").modal("show"))},t.dodataEdit=function(a){t.dataEdit=a,t.dataEdit.edit=!0,$(".edit-modal").modal("show")},t.dodataDelete=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((i=>{console.log(i),"cancel"!==i.dismiss&&($.blockUI({}),l.post("admin/adminkab/delete",{admin_id:a},(function(a){console.log(a),$.unblockUI({}),a.success?(t.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:a.message,timer:1e3})})))}))},t.saveEdit=function(){$(".edit-modal").modal("hide"),$.blockUI({}),l.post("admin/adminkab/save",t.dataEdit,(function(a){console.log(a),$.unblockUI({}),a.success?(t.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:a.message,timer:1e3}).then((t=>{t.dismiss===Swal.DismissReason.timer&&$(".edit-modal").modal("show")}))}))},1==a.masterprov.length&&(t.selectData.prov_id=a.masterprov[0].prov_id,t.reloadTable()),t.$on("ProvChange",(function(a,i){1==i.length&&(t.selectData.prov_id=i[0].prov_id,t.reloadTable())}))}]);
angular.module("RdmApp").controller("adminprovCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(t,a,i,e,o,n,s,l,r){"admin"!==a.userData.status&&(window.location.href="/"+a.userData.status),t.dtInstance={},t.dataEdit={},t.selectData={},t.selectData.prov_id="",t.currPg=0,t.dtOptions=e.newOptions().withOption("searching",!0).withOption("stateSave",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,4,3,1,2]},titleAttr:"Print",customize:function(t){a.customepdf(t,"Data Admin Provinsi","Pangkalan Data AKMI")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,4,3,1,2]},titleAttr:"Excel"}]).withOption("drawCallback",(function(a){if(t.currPg=0,a.aoData.length>0){var i=this.api().page.info();console.log(i),t.currPg=i.start}})).withOption("language",{paginate:{first:"<i class='fa fa-fast-backward'></i>",previous:"<i class='fa fa-step-backward'></i>",next:"<i class='fa fa-step-forward'></i>",last:"<i class='fa fa-fast-forward'></i>|"}}).withDOM("lBfrtip").withOption("responsive",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withOption("aaSorting",[0,"asc"]).withPaginationType("full_numbers"),a.dataadminprov={},t.reloadTable=function(){a.datalembaga={},""!==t.selectData.kelas_id&&($(".table-responsive").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),l.post("admin/adminprov/data",t.selectData,(function(t){$(".table-responsive").unblock({}),a.dataadminprov=t.data})))},t.reloadTable(),t.tambahData=function(){t.dataEdit={},t.dataEdit.edit=!1,$(".edit-modal").modal("show")},t.dodataEdit=function(a){t.dataEdit=a,t.dataEdit.edit=!0,$(".edit-modal").modal("show")},t.dodataDelete=function(i){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((e=>{console.log(e),"cancel"!==e.dismiss&&($.blockUI({}),l.post("admin/adminprov/delete",{admin_id:i},(function(i){console.log(i),$.unblockUI({}),i.success?(t.reloadTable(),a.getdataprov(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:i.message,timer:1e3})})))}))},t.saveEdit=function(){$(".edit-modal").modal("hide"),$.blockUI({}),l.post("admin/adminprov/save",t.dataEdit,(function(i){console.log(i),$.unblockUI({}),i.success?(t.reloadTable(),a.getdataprov(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:i.message,timer:1e3}).then((t=>{t.dismiss===Swal.DismissReason.timer&&$(".edit-modal").modal("show")}))}))}}]);
angular.module("RdmApp").controller("aktiflembagaCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$compile",function(a,e,t,n,i,l,o,s,r,d){a.dtInstance={},a.selectData={},a.selectData.prov_id="",a.currPg=0,a.dtColumns=[i.newColumn("no").withTitle("#").notSortable(),i.newColumn("lembaga_nsm").withTitle("NSM"),i.newColumn("lembaga_nama").withTitle("Nama Lembaga"),i.newColumn("jenjang_nama").withTitle("Jenjang"),i.newColumn("total").withTitle("Aktif").notSortable(),i.newColumn("provinsi_nama").withTitle("Provinsi"),i.newColumn("kota_nama").withTitle("Kab/Ko"),i.newColumn(null).withTitle("Aksi").notSortable().renderWith((function(a,e,t,n){return""}))],a.dtOptions=n.newOptions().withOption("ajax",(function(e,t,n){console.log(e),$(".table-responsive").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),function(e){return void 0!==a.selectData.prov_id?(e.prov_id=a.selectData.prov_id,e.kab_id=a.selectData.kab_id,e.jenjang_id=a.selectData.jenjang_id,l({method:"POST",url:"admin/lembaga/dataaktif",data:e})):null}(e).success((function(a){$(".table-responsive").unblock({}),t({recordsTotal:a.results.recordsTotal,recordsFiltered:a.results.recordsFiltered,data:a.results.data})}))})).withDataProp("data").withDOM("lBfrtip").withOption("searching",!0).withOption("stateSave",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> PDF',download:"open",exportOptions:{columns:[0,1,2,3,4,5,6,7]},titleAttr:"Print",customize:function(a){e.customepdf(a,"Data Lembaga","Pangkalan Data AKMI")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,1,2,3,4,5,6,7]},titleAttr:"Excel"}]).withOption("drawCallback",(function(e){if(a.currPg=0,e.aoData.length>0){var t=this.api().page.info();console.log(t),a.currPg=t}})).withOption("responsive",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withOption("serverSide",!0).withOption("aaSorting",[0,"asc"]).withOption("createdRow",(function(e){d(angular.element(e).contents())(a)})).withPaginationType("full_numbers"),a.syncLembaga=function(e){$.blockUI({message:"<h4>Harap bersabar...</h4>Sedang Proses Syncron"}),s.get("admin/lembaga/syncemis/"+e,(function(e){$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Syncron",showConfirmButton:!1,html:"Syncron data lembaga berhasil",timer:1e3})):Swal.fire({type:"error",title:"Syncron",showConfirmButton:!0,html:"Rincian data lembaga di emis tidak tersedia"})}))},e.datalembaga={},a.reloadTable=function(){$("#aktifTable").DataTable().ajax.reload()},a.dodataEdit=function(t){e.readKec(t.kota_id),a.dataEdit=t,a.dataEdit.edit=!0,$(".edit-modal").modal("show")},e.datakab=[],e.datakec=[],e.autoName=function(){if(a.dataEdit.lembaga_nama.length<5){var e="";if("2"==a.dataEdit.jenjang_id)e="MI";else if("3"==a.dataEdit.jenjang_id)e="MTs";else if("4"==a.dataEdit.jenjang_id)e="MA";var t="";if("1"==a.dataEdit.lembaga_status)t="N ";else if("2"==a.dataEdit.lembaga_status)t="S ";""!==e&&""!==t&&(a.dataEdit.lembaga_nama=e+t)}},e.readKec=function(a){e.datakec=[],""!==a&&($("#selectKecamatan").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),s.post("admin/admin/kec",{kab_id:a},(function(a){e.datakec=a.data,$("#selectKecamatan").unblock()})))},e.readKab=function(){a.reloadTable(),e.newreadKab()},e.newreadKab=function(){$("#kabupaten").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),a.selectData.kab_id="",e.datakab=[],""!==a.selectData.prov_id?s.post("admin/admin/kab",{prov_id:a.selectData.prov_id},(function(t){e.datakab=t.data,1==e.datakab.length&&(a.selectData.kab_id=e.datakab[0].kab_id,a.reloadTable()),$("#kabupaten").unblock()})):$("#kabupaten").unblock()},1==e.masterprov.length&&(a.selectData.prov_id=e.masterprov[0].prov_id,e.newreadKab()),a.$on("ProvChange",(function(t,n){1==n.length&&(a.selectData.prov_id=n[0].prov_id,e.newreadKab())})),a.dodataDelete=function(e){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((t=>{console.log(t),"cancel"!==t.dismiss&&($.blockUI({}),s.post("admin/lembaga/delete",{lembaga_id:e},(function(e){console.log(e),$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:e.message,timer:1e3})})))}))},a.saveeditlembaga=function(){$(".edit-modal").modal("hide"),$.blockUI({}),s.post("admin/lembaga/save",a.dataEdit,(function(e){console.log(e),$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:e.message,timer:1e3}).then((a=>{a.dismiss===Swal.DismissReason.timer&&$(".edit-modal").modal("show")}))}))};var c=a.uploader=new r({url:base_url+"admin/lembaga/import"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){c.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},c.filters.push({name:"customFilter",fn:function(a,e){return this.queue.length<100}}),c.filters.push({name:"imageFilter",fn:function(a,e){var t="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",t),-1!=="|xls|xlsx|".indexOf(t)}}),c.onSuccessItem=function(e,t,n,i){console.log(n),a.berhasilka=a.berhasilka+t.sukses,a.gandaaa=a.gandaaa+t.double1,a.gagalaa=a.gagalaa+t.gagal,a.hasilupload=t.lembaga,a.$apply(),console.info("onSuccessItem",e,t,n,i,a.gandaaa)},c.onCompleteAll=function(){e.readKab(),a.reloadTable()},c.onBeforeUploadItem=function(e){a.hasilupload={},e.url=base_url+"admin/lembaga/import?prov_id="+a.selectData.prov_id+"&kab_id="+a.selectData.kab_id},c.onAfterAddingAll=function(a){c.uploadAll()}}]);
angular.module("RdmApp").controller("carilembagaCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,e,t,i,n,l,o,s,r){a.dtInstance={},a.keyword="",a.currPg=0,a.dtOptions=i.newOptions().withOption("searching",!0).withOption("stateSave",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> PDF',download:"open",exportOptions:{columns:[0,1,2,3,4,5,6,7]},titleAttr:"Print",customize:function(a){e.customepdf(a,"Data Lembaga","Pangkalan Data AKMI")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,1,2,3,4,5,6,7]},titleAttr:"Excel"}]).withOption("drawCallback",(function(e){if(a.currPg=0,e.aoData.length>0){var t=this.api().page.info();console.log(t),a.currPg=t.start}})).withOption("responsive",!0).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withPaginationType("full_numbers"),a.syncLembaga=function(e){$.blockUI({message:"<h4>Harap bersabar...</h4>Sedang Proses Syncron"}),s.get("admin/lembaga/syncemis/"+e,(function(e){$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Syncron",showConfirmButton:!1,html:"Syncron data lembaga berhasil",timer:1e3})):Swal.fire({type:"error",title:"Syncron",showConfirmButton:!0,html:"Rincian data lembaga di emis tidak tersedia"})}))},e.datalembaga={},a.reloadTable=function(){$(".table-responsive").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),s.post("admin/lembaga/caridata",{keyword:a.keyword},(function(a){$(".table-responsive").unblock({}),e.datalembaga=a.data}))},a.dodataEdit=function(t){e.readKab(t.provinsi_id),e.readKec(t.kota_id),a.dataEdit=t,a.dataEdit.edit=!0,$(".edit-modal").modal("show")},e.datakab=[],e.datakec=[],e.autoName=function(){if(a.dataEdit.lembaga_nama.length<5){var e="";if("2"==a.dataEdit.jenjang_id)e="MI";else if("3"==a.dataEdit.jenjang_id)e="MTs";else if("4"==a.dataEdit.jenjang_id)e="MA";var t="";if("1"==a.dataEdit.lembaga_status)t="N ";else if("2"==a.dataEdit.lembaga_status)t="S ";""!==e&&""!==t&&(a.dataEdit.lembaga_nama=e+t)}},e.readKec=function(a){e.datakec=[],""!==a&&($("#selectKecamatan").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),s.post("admin/admin/kec",{kab_id:a},(function(a){e.datakec=a.data,$("#selectKecamatan").unblock()})))},e.readKab=function(t){$("#selectKab").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),e.datakab=[],""!==t?s.post("admin/admin/kab",{prov_id:t},(function(t){e.datakab=t.data,1==e.datakab.length&&(a.selectData.kab_id=e.datakab[0].kab_id,a.reloadTable()),$("#selectKab").unblock()})):$("#selectKab").unblock()},a.resetToken=function(e){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Reset!",showCancelButton:!0,html:"Apakah Anda yakin akan mereset Token Lembaga ini?"}).then((t=>{console.log(t),"cancel"!==t.dismiss&&($.blockUI({}),s.post("admin/lembaga/resettoken",{lembaga_id:e},(function(e){console.log(e),$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Reset",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:e.message,timer:1e3})})))}))},a.dodataDelete=function(e){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((t=>{console.log(t),"cancel"!==t.dismiss&&($.blockUI({}),s.post("admin/lembaga/delete",{lembaga_id:e},(function(e){console.log(e),$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:e.message,timer:1e3})})))}))},a.saveeditlembaga=function(){$(".edit-modal").modal("hide"),$.blockUI({}),s.post("admin/lembaga/save",a.dataEdit,(function(e){console.log(e),$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:e.message,timer:1e3}).then((a=>{a.dismiss===Swal.DismissReason.timer&&$(".edit-modal").modal("show")}))}))};var d=a.uploader=new r({url:base_url+"admin/lembaga/import"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){d.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},d.filters.push({name:"customFilter",fn:function(a,e){return this.queue.length<100}}),d.filters.push({name:"imageFilter",fn:function(a,e){var t="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",t),-1!=="|xls|xlsx|".indexOf(t)}}),d.onSuccessItem=function(e,t,i,n){console.log(i),a.berhasilka=a.berhasilka+t.sukses,a.gandaaa=a.gandaaa+t.double1,a.gagalaa=a.gagalaa+t.gagal,a.hasilupload=t.lembaga,a.$apply(),console.info("onSuccessItem",e,t,i,n,a.gandaaa)},d.onCompleteAll=function(){e.readKab(),a.reloadTable()},d.onBeforeUploadItem=function(e){a.hasilupload={},e.url=base_url+"admin/lembaga/import?prov_id="+a.selectData.prov_id+"&kab_id="+a.selectData.kab_id},d.onAfterAddingAll=function(a){d.uploadAll()}}]);
angular.module("RdmApp").controller("datasiswaCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$compile",function(a,e,t,i,n,s,l,o,r,c){a.dtInstance={},a.dtInstance2={},a.tabelData=[],a.currPg=0,a.currPg1=0,a.dtColumns=[n.newColumn("no").withTitle("#").notSortable(),n.newColumn("siswa_nopes").withTitle("Nomor Peserta"),n.newColumn("siswa_nisn").withTitle("NISN"),n.newColumn("siswa_nama").withTitle("Nama"),n.newColumn("siswa_tempat").withTitle("Tempat Lahir"),n.newColumn("siswa_tgllahir").withTitle("Tanggal Lahir"),n.newColumn("tingkat_id").withTitle("Tingkat").notSortable(),n.newColumn(null).withTitle("Aksi").notSortable().renderWith((function(a,e,t,i){return""}))],a.dtOptions=i.newOptions().withOption("ajax",(function(e,t,i){console.log(e),$(".table-responsive").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),void 0!==a.selectData.lembaga_id&&""!==a.selectData.lembaga_id?(e.lembaga_id=a.selectData.lembaga_id,o.post("admin/siswa/data",e,(function(e){$(".table-responsive").unblock({}),a.tabelData=e.results.data,t({recordsTotal:e.results.recordsTotal,recordsFiltered:e.results.recordsFiltered,data:e.results.data})}))):($(".table-responsive").unblock({}),t({recordsTotal:0,recordsFiltered:0,data:{}}))})).withDataProp("data").withDOM("lBfrtip").withOption("language",{paginate:{first:"<i class='fa fa-fast-backward'></i>",previous:"<i class='fa fa-step-backward'></i>",next:"<i class='fa fa-step-forward'></i>",last:"<i class='fa fa-fast-forward'></i>|"}}).withOption("searching",!0).withOption("stateSave",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> PDF',download:"open",orientation:"landscape",pageSize:"A4",exportOptions:{columns:":visible",search:"applied",order:"applied"},titleAttr:"Print",customize:function(a){e.customepdf(a,"Data Lembaga","Pangkalan Data AKMI")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,1,2,3,4,5,6,7]},titleAttr:"Excel"}]).withOption("drawCallback",(function(e){if(a.currPg=0,e.aoData.length>0){var t=this.api().page.info();console.log(t),a.currPg=t}})).withOption("responsive",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withOption("serverSide",!0).withOption("aaSorting",[0,"asc"]).withOption("createdRow",(function(e){c(angular.element(e).contents())(a)})).withPaginationType("simple_numbers"),a.dtOptions2=i.newOptions().withOption("searching",!0).withOption("drawCallback",(function(e){if(a.currPg2=0,e.aoData.length>0){var t=this.api().page.info();console.log(t),a.currPg2=t}})).withOption("responsive",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("paging",!0).withOption("stateSave",!0).withOption("processing",!0).withPaginationType("full_numbers"),e.doGenNopes=function(){$.blockUI({message:"<h4>Harap bersabar...</h4>Sedang Proses Generate"}),""!==a.selectData.jenjang_id?o.post("admin/siswa/gennopes",a.selectData,(function(e){$.unblockUI(),e.success?a.reloadTable():Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})})):$.unblockUI()},a.doSyncEmis=function(){$.blockUI({message:"<h4>Chek tahun ajaran</h4>"}),o.get("admin/siswa/chekTaEmis",(function(e){if($.unblockUI(),e.success){var t=e.Emis.id;a.newsync=0,a.processSyncSiswa(1,t)}else Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))},a.newsync=0,a.processSyncSiswa=function(e,t){$.blockUI({message:"<h4>Syncron Data Emis Halaman "+e+"</h4>"}),o.post("admin/siswa/syncEmis/"+a.selectData.lembaga_id,{page:e,ta:t},(function(e){$.unblockUI(),e.success?(a.newsync+=e.update.length,!1!==e.next?a.processSyncSiswa(e.next,t):(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil Syncron",showConfirmButton:!1,html:a.newsync+" siswa emis berhasil di Syncron",timer:2e3}))):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))},e.dataselectLembaga={},a.reloadData=function(){$("#madrasah").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),a.selectData.lembaga_id="",a.reloadTable(),o.post("admin/lembaga/madrasahaktif",a.selectData,(function(a){$("#madrasah").unblock({}),e.dataselectLembaga=a.data}))},a.reloadTable=function(){localStorage.setItem("selectData",JSON.stringify(a.selectData));try{$("#aktifTable").DataTable().ajax.reload()}catch(a){}},a.dodataEdit=function(t){a.dataEdit=e.arrPush(a.tabelData[t]),$(".edit-moda").modal("show")},e.autoName=function(){if(a.dataEdit.lembaga_nama.length<5){var e="";if("2"==a.dataEdit.jenjang_id)e="MI";else if("3"==a.dataEdit.jenjang_id)e="MTs";else if("4"==a.dataEdit.jenjang_id)e="MA";var t="";if("1"==a.dataEdit.lembaga_status)t="N ";else if("2"==a.dataEdit.lembaga_status)t="S ";""!==e&&""!==t&&(a.dataEdit.lembaga_nama=e+t)}},e.readKec=function(a){e.datakec=[],""!==a&&($("#selectKecamatan").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),o.post("admin/admin/kec",{kab_id:a},(function(a){e.datakec=a.data,$("#selectKecamatan").unblock()})))},e.readKab=function(){e.newreadKab()},e.newreadKab=function(){$("#kabupaten").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),a.selectData.kab_id="",e.datakab=[],""!==a.selectData.prov_id?o.post("admin/admin/kab",{prov_id:a.selectData.prov_id},(function(t){e.datakab=t.data,1==e.datakab.length&&(a.selectData.kab_id=e.datakab[0].kab_id,a.reloadData()),$("#kabupaten").unblock()})):$("#kabupaten").unblock()},a.$on("ProvChange",(function(t,i){1==i.length&&(a.selectData.prov_id=i[0].prov_id,e.newreadKab())})),a.dodataDelete=function(e){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((t=>{console.log(t),"cancel"!==t.dismiss&&($.blockUI({}),o.post("admin/lembaga/delete",{lembaga_id:e},(function(e){console.log(e),$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:e.message,timer:1e3})})))}))},a.savePelaksanaan=function(){$(".edit-moda").modal("hide"),$.blockUI({}),o.post("admin/lembaga/savepelaksana",a.dataEdit,(function(e){console.log(e),$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:e.message,timer:1e3}).then((a=>{a.dismiss===Swal.DismissReason.timer&&$(".edit-moda").modal("show")}))}))},a.tambahPelaksana=function(){""==a.selectData.prov_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih provinsi terlebih dahulu",timer:1e3}):""==a.selectData.kab_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih kabupaten terlebih dahulu",timer:1e3}):(a.updateTable(),$(".edit-modal").modal("show"))},a.dotambahPelaksana=function(e){$(".tabel-reload").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),o.post("admin/lembaga/tambahpelaksana",e,(function(e){$(".tabel-reload").unblock({}),e.success?(a.updateTable(),a.reloadTable(),Swal.fire({type:"success",title:"Syncron",showConfirmButton:!1,html:"Lembaga berhasil ditambahkan",timer:1e3})):Swal.fire({type:"error",title:"Syncron",showConfirmButton:!0,html:"Lembaga gagal ditambahkan"})}))},e.newKab=function(){$("#kabupaten").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),""!==a.selectData.prov_id?o.post("admin/admin/kab",{prov_id:a.selectData.prov_id},(function(t){e.datakab=t.data,$("#kabupaten").unblock(),1==e.datakab.length?(a.selectData.kab_id=e.datakab[0].kab_id,a.reloadData()):void 0!==a.selectData.kab_id&&""!==a.selectData.kab_id&&a.reloadData1()})):$("#kabupaten").unblock()},a.reloadData1=function(){$("#madrasah").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),a.selectData.lembaga_id="",o.post("admin/lembaga/madrasahaktif",a.selectData,(function(a){$("#madrasah").unblock({}),e.dataselectLembaga=a.data}))};try{a.selectData=JSON.parse(localStorage.getItem("selectData")||{})}catch(e){a.selectData={}}1==e.masterprov.length?(a.selectData.prov_id=e.masterprov[0].prov_id,e.newKab()):Object.keys(a.selectData).length>0?(null==e.datakab&&e.newKab(),""!==a.selectData.kab_id&&a.reloadData1()):(a.selectData.prov_id="",a.selectData.kab_id="",a.selectData.lembaga_id="");a.uploader=new r({url:base_url+"admin/lembaga/import"})}]);
angular.module("RdmApp").controller("filemanagemenCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(e,a,t,n,o,i,l,s,r){e.dtInstance={},e.selectData={},e.selectData.prov_id="",e.currPg=0,e.dtOptions=n.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("drawCallback",(function(a){if(e.currPg=0,a.aoData.length>0){var t=this.api().page.info();console.log(t),e.currPg=t.start}})).withOption("responsive",!0).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withPaginationType("full_numbers"),a.datalembaga={},e.reloadTable=function(){$(".table-responsive").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),s.post("admin/filemanagemen/data",e.selectData,(function(e){$(".table-responsive").unblock({}),a.datalembaga=e.data}))},e.reloadTable(),e.allowext="",e.filekey="",e.tipefile=function(a){e.filekey=a,e.allowext=a.split(".").pop()},e.dodataEdit=function(a){e.dataEdit=a,e.dataEdit.edit=!0,$(".edit-modal").modal("show")},e.dodataDelete=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((t=>{console.log(t),"cancel"!==t.dismiss&&($.blockUI({}),s.post("admin/filemanagemen/delete",a,(function(a){console.log(a),$.unblockUI({}),a.success?(e.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:a.message,timer:1e3})})))}))};var u=e.uploader=new r({url:base_url+"admin/filemanagemen/upload"});e.hapussemua=function(){u.clearQueue()},u.filters.push({name:"customFilter",fn:function(e,a){return this.queue.length<100}}),u.filters.push({name:"imageFilter",fn:function(a,t){var n="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",n),"|"+e.allowext+"|".indexOf(n)!==-1}}),u.onSuccessItem=function(a,t,n,o){console.log(n),console.info("onSuccessItem",a,t,n,o,e.gandaaa)},u.onCompleteAll=function(){$(".upload-modal").modal("hide"),e.hapussemua(),e.reloadTable()},u.onBeforeUploadItem=function(a){e.hasilupload={},a.url=base_url+"admin/filemanagemen/upload?key="+e.filekey},u.onAfterAddingAll=function(e){u.uploadAll()}}]);
angular.module("RdmApp").controller("kabupatenCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,t,e,i,o,n,l,r,s){"adminkab"==t.userData.status&&(window.location.href="/adminkab"),a.dtInstance={},a.mergerData={},a.selectData={},a.selectData.prov_id="",a.currPg=0,console.log(t.userData),a.dtOptions=i.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(a){t.customepdf(a,"Data Kabupaten","Pangkalan Data AKMI")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("drawCallback",(function(t){if(a.currPg=0,t.aoData.length>0){var e=this.api().page.info();console.log(e),a.currPg=e.start}})).withOption("language",{paginate:{first:"<i class='fa fa-fast-backward'></i>",previous:"<i class='fa fa-step-backward'></i>",next:"<i class='fa fa-step-forward'></i>",last:"<i class='fa fa-fast-forward'></i>|"}}).withDOM("lBfrtip").withOption("responsive",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withOption("aaSorting",[0,"asc"]).withPaginationType("full_numbers"),a.dataEdit={},a.dodataEdit=function(e){a.dataEdit=t.arrPush(e),a.dataEdit.edit=!0;try{a.$apply()}catch(a){}$(".edit-modal").modal("show")},a.saveediKab=function(){$(".edit-modal").modal("hide"),$.blockUI({}),r.post("admin/kabupaten/save",a.dataEdit,(function(a){$.unblockUI({}),a.success?(t.readKab(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:a.message,timer:1e3}).then((a=>{a.dismiss===Swal.DismissReason.timer&&$(".edit-modal").modal("show")}))}))},t.datalembaga={},a.reloadTable=function(){t.datalembaga={},""!==a.selectData.kelas_id&&($.blockUI({}),r.post("admin/lembaga/data",a.selectData,(function(a){$.unblockUI({}),t.datalembaga=a.data})))},a.processMerger=function(){""!==a.mergerData.tujuankab_id?($(".merger-modal").modal("hide"),$.blockUI({}),r.post("admin/kabupaten/merger",a.mergerData,(function(a){$.unblockUI({}),a.success?(t.readKab(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dimerger",timer:1e3})):($(".merger-modal").modal("show"),Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:a.message,timer:1e3}))}))):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:"Tujuan merger belum di pilih",timer:1e3})},a.dodataMerger=function(t){a.mergerData=t,a.mergerData.tujuankab_id="",$(".merger-modal").modal("show")},t.datakab=[],t.readKab=function(){$(".table-responsive").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),a.selectData.kab_id="",t.datakab=[],""!==a.selectData.prov_id?r.post("admin/admin/kab",{prov_id:a.selectData.prov_id},(function(a){t.datakab=a.data,$(".table-responsive").unblock()})):$(".table-responsive").unblock()},1==t.masterprov.length&&(a.selectData.prov_id=t.masterprov[0].prov_id,t.readKab()),a.$on("ProvChange",(function(e,i){1==i.length&&(a.selectData.prov_id=i[0].prov_id,t.readKab())})),a.tambahKab=function(){a.dataEdit={},a.dataEdit.edit=!1,$(".edit-modal").modal("show")};var d=a.uploader=new s({url:base_url+"admin/lembaga/import"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){d.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},d.filters.push({name:"customFilter",fn:function(a,t){return this.queue.length<100}}),d.filters.push({name:"imageFilter",fn:function(a,t){var e="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",e),-1!=="|xls|xlsx|".indexOf(e)}}),d.onSuccessItem=function(t,e,i,o){console.log(i),a.berhasilka=a.berhasilka+e.sukses,a.gandaaa=a.gandaaa+e.double1,a.gagalaa=a.gagalaa+e.gagal,a.hasilupload=e.lembaga,a.$apply(),console.info("onSuccessItem",t,e,i,o,a.gandaaa)},d.onCompleteAll=function(){t.readKab(),a.reloadTable()},d.onBeforeUploadItem=function(t){a.hasilupload={},t.url=base_url+"admin/lembaga/import?prov_id="+a.selectData.prov_id+"&kab_id="+a.selectData.kab_id},d.onAfterAddingAll=function(a){d.uploadAll()}}]);
angular.module("RdmApp").controller("kecamatanCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,t,e,i,n,o,l,s,r){a.dtInstance={},a.mergerData={},a.selectData={},a.selectData.prov_id="",a.currPg=0,a.dtOptions=i.newOptions().withOption("searching",!0).withOption("stateSave",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(a){t.customepdf(a,"Data Kecamatan","Pangkalan Data AKMI")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("drawCallback",(function(t){if(a.currPg=0,t.aoData.length>0){var e=this.api().page.info();console.log(e),a.currPg=e.start}})).withOption("language",{paginate:{first:"<i class='fa fa-fast-backward'></i>",previous:"<i class='fa fa-step-backward'></i>",next:"<i class='fa fa-step-forward'></i>",last:"<i class='fa fa-fast-forward'></i>|"}}).withDOM("lBfrtip").withOption("responsive",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withOption("aaSorting",[0,"asc"]).withPaginationType("full_numbers"),a.processMerger=function(){""!==a.mergerData.tujuankec_id?($(".merger-modal").modal("hide"),$.blockUI({}),s.post("admin/kecamatan/merger",a.mergerData,(function(a){$.unblockUI({}),a.success?(t.readKec(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dimerger",timer:1e3})):($(".merger-modal").modal("show"),Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:a.message,timer:1e3}))}))):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:"Tujuan merger belum di pilih",timer:1e3})},a.dataEdit={},a.tambahKecamatan=function(){a.dataEdit={},a.dataEdit.edit=!1,$(".edit-modal").modal("show")},a.dodataEdit=function(t){a.dataEdit=t,a.dataEdit.edit=!0;try{a.$apply()}catch(a){}$(".edit-modal").modal("show")},a.saveeditKec=function(){$(".edit-modal").modal("hide"),$.blockUI({}),s.post("admin/kecamatan/save",a.dataEdit,(function(a){$.unblockUI({}),a.success?(t.readKec(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:a.message,timer:1e3}).then((a=>{a.dismiss===Swal.DismissReason.timer&&$(".edit-modal").modal("show")}))}))},a.dodataMerger=function(t){a.mergerData=t,a.mergerData.tujuankec_id="",$(".merger-modal").modal("show")},t.datakab=[],t.readKab=function(){$("#kabupaten").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),a.selectData.kab_id="",t.datakab=[],""!==a.selectData.prov_id?s.post("admin/admin/kab",{prov_id:a.selectData.prov_id},(function(e){t.datakab=e.data,$("#kabupaten").unblock(),1==t.datakab.length&&(a.selectData.kab_id=t.datakab[0].kab_id,a.readKec())})):$("#kabupaten").unblock()},t.datakec=[],t.readKec=function(){$(".table-responsive").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),t.datakec=[],""!==a.selectData.kab_id?s.post("admin/admin/kec",{kab_id:a.selectData.kab_id},(function(a){$(".table-responsive").unblock({}),t.datakec=a.data})):$(".table-responsive").unblock({})},1==t.masterprov.length&&(a.selectData.prov_id=t.masterprov[0].prov_id,t.readKab()),a.$on("ProvChange",(function(e,i){1==i.length&&(a.selectData.prov_id=i[0].prov_id,t.readKab())}));var d=a.uploader=new r({url:base_url+"admin/lembaga/import"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){d.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},d.filters.push({name:"customFilter",fn:function(a,t){return this.queue.length<100}}),d.filters.push({name:"imageFilter",fn:function(a,t){var e="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",e),-1!=="|xls|xlsx|".indexOf(e)}}),d.onSuccessItem=function(t,e,i,n){console.log(i),a.berhasilka=a.berhasilka+e.sukses,a.gandaaa=a.gandaaa+e.double1,a.gagalaa=a.gagalaa+e.gagal,a.hasilupload=e.lembaga,a.$apply(),console.info("onSuccessItem",t,e,i,n,a.gandaaa)},d.onCompleteAll=function(){t.readKab()},d.onBeforeUploadItem=function(t){a.hasilupload={},t.url=base_url+"admin/lembaga/import?prov_id="+a.selectData.prov_id+"&kab_id="+a.selectData.kab_id},d.onAfterAddingAll=function(a){d.uploadAll()}}]);
angular.module("RdmApp").controller("kelengkapanCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$compile",function(a,e,t,i,s,n,l,o,r,c){a.dtInstance={},a.dtInstance2={},a.tabelData=[],a.currPg=0,a.currPg1=0,a.dtColumns=[s.newColumn("no").withTitle("#").notSortable(),s.newColumn("siswa_nisn").withTitle("NISN"),s.newColumn("siswa_nama").withTitle("Nama"),s.newColumn("siswa_nopes").withTitle("Nomor Peserta").renderWith((function(e,t,i,s){return null!==a.tabelData[s.row].siswa_nopes&&""!==a.tabelData[s.row].siswa_nopes?'<span class="text-success"><i class="c-icon fa fa-check "></i></span><span ng-hide="1">OK</span>':'<span class="text-danger"><i class="c-icon fa fa-close "></i></span><span ng-hide="1">-</span>'})),s.newColumn("siswa_periode").withTitle("Periode").renderWith((function(e,t,i,s){return null!==a.tabelData[s.row].siswa_periode&&""!==a.tabelData[s.row].siswa_periode?'<span class="text-success"><i class="c-icon fa fa-check "></i></span><span ng-hide="1">OK</span>':'<span class="text-danger"><i class="c-icon fa fa-close "></i></span><span ng-hide="1">-</span>'})),s.newColumn("siswa_ruang").withTitle("Ruang").renderWith((function(e,t,i,s){return null!==a.tabelData[s.row].siswa_ruang&&""!==a.tabelData[s.row].siswa_ruang?'<span class="text-success"><i class="c-icon fa fa-check "></i></span><span ng-hide="1">OK</span>':'<span class="text-danger"><i class="c-icon fa fa-close "></i></span><span ng-hide="1">-</span>'})),s.newColumn("siswa_sesi").withTitle("Sesi").renderWith((function(e,t,i,s){return null!==a.tabelData[s.row].siswa_sesi&&""!==a.tabelData[s.row].siswa_sesi?'<span class="text-success"><i class="c-icon fa fa-check "></i></span><span ng-hide="1">OK</span>':'<span class="text-danger"><i class="c-icon fa fa-close "></i></span><span ng-hide="1">-</span>'}))],a.dtOptions=i.newOptions().withOption("ajax",(function(e,t,i){console.log(e),$(".table-responsive").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),void 0!==a.selectData.lembaga_id&&""!==a.selectData.lembaga_id?(e.lembaga_id=a.selectData.lembaga_id,o.post("admin/siswa/data",e,(function(e){$(".table-responsive").unblock({}),a.tabelData=e.results.data,t({recordsTotal:e.results.recordsTotal,recordsFiltered:e.results.recordsFiltered,data:e.results.data})}))):($(".table-responsive").unblock({}),t({recordsTotal:0,recordsFiltered:0,data:{}}))})).withDataProp("data").withDOM("lBfrtip").withOption("language",{paginate:{first:"<i class='fa fa-fast-backward'></i>",previous:"<i class='fa fa-step-backward'></i>",next:"<i class='fa fa-step-forward'></i>",last:"<i class='fa fa-fast-forward'></i>|"}}).withOption("searching",!0).withOption("stateSave",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> PDF',download:"open",orientation:"landscape",pageSize:"A4",exportOptions:{columns:":visible",search:"applied",order:"applied"},titleAttr:"Print",customize:function(a){e.customepdf(a,"Data Lembaga","Pangkalan Data AKMI")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,1,2,3,4,5,6,7]},titleAttr:"Excel"}]).withOption("drawCallback",(function(e){if(a.currPg=0,e.aoData.length>0){var t=this.api().page.info();console.log(t),a.currPg=t}})).withOption("columnDefs",[{responsivePriority:1,targets:1},{responsivePriority:3,targets:2},{responsivePriority:2,targets:-1}]).withOption("responsive",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withOption("serverSide",!0).withOption("aaSorting",[0,"asc"]).withOption("createdRow",(function(e){c(angular.element(e).contents())(a)})).withPaginationType("simple_numbers"),a.dtOptions2=i.newOptions().withOption("searching",!0).withOption("drawCallback",(function(e){if(a.currPg2=0,e.aoData.length>0){var t=this.api().page.info();console.log(t),a.currPg2=t}})).withOption("responsive",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("paging",!0).withOption("stateSave",!0).withOption("processing",!0).withPaginationType("full_numbers"),e.doGenNopes=function(){$.blockUI({message:"<h4>Harap bersabar...</h4>Sedang Proses Generate"}),""!==a.selectData.jenjang_id?o.post("admin/siswa/gennopes",a.selectData,(function(e){$.unblockUI(),e.success?a.reloadTable():Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})})):$.unblockUI()},a.doSyncEmis=function(){$.blockUI({message:"<h4>Chek tahun ajaran</h4>"}),o.get("admin/siswa/chekTaEmis",(function(e){if($.unblockUI(),e.success){var t=e.Emis.id;a.newsync=0,a.processSyncSiswa(1,t)}else Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))},a.newsync=0,a.processSyncSiswa=function(e,t){$.blockUI({message:"<h4>Syncron Data Emis Halaman "+e+"</h4>"}),o.post("admin/siswa/syncEmis/"+a.selectData.lembaga_id,{page:e,ta:t},(function(e){$.unblockUI(),e.success?(a.newsync+=e.update.length,!1!==e.next?a.processSyncSiswa(e.next,t):(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil Syncron",showConfirmButton:!1,html:a.newsync+" siswa emis berhasil di Syncron",timer:2e3}))):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))},e.dataselectLembaga={},a.reloadData=function(){$("#madrasah").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),a.selectData.lembaga_id="",a.reloadTable(),o.post("admin/lembaga/madrasahaktif",a.selectData,(function(a){$("#madrasah").unblock({}),e.dataselectLembaga=a.data}))},a.reloadTable=function(){localStorage.setItem("selectData",JSON.stringify(a.selectData));try{$("#aktifTable").DataTable().ajax.reload()}catch(a){}},a.dodataEdit=function(t){a.dataEdit=e.arrPush(a.tabelData[t]),$(".edit-moda").modal("show")},e.autoName=function(){if(a.dataEdit.lembaga_nama.length<5){var e="";if("2"==a.dataEdit.jenjang_id)e="MI";else if("3"==a.dataEdit.jenjang_id)e="MTs";else if("4"==a.dataEdit.jenjang_id)e="MA";var t="";if("1"==a.dataEdit.lembaga_status)t="N ";else if("2"==a.dataEdit.lembaga_status)t="S ";""!==e&&""!==t&&(a.dataEdit.lembaga_nama=e+t)}},e.readKec=function(a){e.datakec=[],""!==a&&($("#selectKecamatan").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),o.post("admin/admin/kec",{kab_id:a},(function(a){e.datakec=a.data,$("#selectKecamatan").unblock()})))},e.readKab=function(){e.newreadKab()},e.newreadKab=function(){$("#kabupaten").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),a.selectData.kab_id="",e.datakab=[],""!==a.selectData.prov_id?o.post("admin/admin/kab",{prov_id:a.selectData.prov_id},(function(t){e.datakab=t.data,1==e.datakab.length&&(a.selectData.kab_id=e.datakab[0].kab_id,a.reloadData1()),$("#kabupaten").unblock()})):$("#kabupaten").unblock()},a.$on("ProvChange",(function(t,i){1==i.length&&(a.selectData.prov_id=i[0].prov_id,e.newreadKab())})),a.dodataDelete=function(e){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((t=>{console.log(t),"cancel"!==t.dismiss&&($.blockUI({}),o.post("admin/lembaga/delete",{lembaga_id:e},(function(e){console.log(e),$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:e.message,timer:1e3})})))}))},a.savePelaksanaan=function(){$(".edit-moda").modal("hide"),$.blockUI({}),o.post("admin/lembaga/savepelaksana",a.dataEdit,(function(e){console.log(e),$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:e.message,timer:1e3}).then((a=>{a.dismiss===Swal.DismissReason.timer&&$(".edit-moda").modal("show")}))}))},a.tambahPelaksana=function(){""==a.selectData.prov_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih provinsi terlebih dahulu",timer:1e3}):""==a.selectData.kab_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih kabupaten terlebih dahulu",timer:1e3}):(a.updateTable(),$(".edit-modal").modal("show"))},a.dotambahPelaksana=function(e){$(".tabel-reload").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),o.post("admin/lembaga/tambahpelaksana",e,(function(e){$(".tabel-reload").unblock({}),e.success?(a.updateTable(),a.reloadTable(),Swal.fire({type:"success",title:"Syncron",showConfirmButton:!1,html:"Lembaga berhasil ditambahkan",timer:1e3})):Swal.fire({type:"error",title:"Syncron",showConfirmButton:!0,html:"Lembaga gagal ditambahkan"})}))},e.newKab=function(){$("#kabupaten").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),""!==a.selectData.prov_id?o.post("admin/admin/kab",{prov_id:a.selectData.prov_id},(function(t){if(e.datakab=t.data,$("#kabupaten").unblock(),1==e.datakab.length)a.selectData.kab_id=e.datakab[0].kab_id,a.reloadData1();else if(void 0!==a.selectData.kab_id&&""!==a.selectData.kab_id){angular.forEach(e.datakab,(function(e,t){if(e.kab_id==a.selectData.kab_id){a.reloadData1()}})),a.selectData.kab_id=""}})):$("#kabupaten").unblock()},a.reloadData1=function(){$("#madrasah").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),a.selectData.lembaga_id="",o.post("admin/lembaga/madrasahaktif",a.selectData,(function(a){$("#madrasah").unblock({}),e.dataselectLembaga=a.data}))};try{a.selectData=JSON.parse(localStorage.getItem("selectData")||{})}catch(e){a.selectData={}}1==e.masterprov.length?(a.selectData.prov_id=e.masterprov[0].prov_id,e.newKab()):Object.keys(a.selectData).length>0?(null==e.datakab&&e.newKab(),""!==a.selectData.kab_id&&a.reloadData1()):(a.selectData.prov_id="",a.selectData.kab_id="",a.selectData.lembaga_id="");a.uploader=new r({url:base_url+"admin/lembaga/import"})}]);
angular.module("RdmApp").controller("lembagaCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,e,t,i,n,l,o,s,r){a.dtInstance={},a.selectData={},a.currPg=0,a.kab_nama="",a.dtOptions=i.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> PDF',download:"open",orientation:"potrait",pageSize:"A4",exportOptions:{columns:[0,1,2,3,4,5,6,7],search:"applied",order:"applied"},titleAttr:"Print",customize:function(t){e.customepdf(t,"Data Lembaga "+a.kab_nama,"Pangkalan Data AKMI")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,1,2,3,4,5,6,7],stripHtml:!1,rows:".printabled"},titleAttr:"Excel"}]).withOption("drawCallback",(function(e){if(a.currPg=0,e.aoData.length>0){var t=this.api().page.info();console.log(t),a.currPg=t.start}})).withOption("columnDefs",[{responsivePriority:1,targets:1},{responsivePriority:3,targets:2},{responsivePriority:2,targets:-1}]).withOption("language",{paginate:{first:"<i class='fa fa-fast-backward'></i>",previous:"<i class='fa fa-step-backward'></i>",next:"<i class='fa fa-step-forward'></i>",last:"<i class='fa fa-fast-forward'></i>|"}}).withDOM("lBfrtip").withOption("responsive",!0).withOption("paging",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("stateSave",!0).withOption("processing",!0).withPaginationType("full_numbers"),e.datalembaga={},a.doupdateEmis=function(){e.datakab.length>0&&a.updateEmis(0)},a.doUpdateEmis=function(){$.blockUI({message:"<h4>Harap bersabar...</h4>Sedang Proses Syncron"}),s.get("admin/lembaga/reademis/"+a.selectData.prov_id+"/"+a.selectData.kab_id,(function(e){$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Syncron",showConfirmButton:!1,html:"Syncron data lembaga berhasil",timer:1e3})):Swal.fire({type:"error",title:"Syncron",showConfirmButton:!0,html:"Gagal Syncron data."})}))},a.updateEmis=function(t){if(e.datakab.length>t){var i=Math.round(100*t/e.datakab.length,0);$.blockUI({message:"<h4>Harap bersabar...</h4>Sedang Proses Syncron "+i+"%"}),s.get("admin/lembaga/reademis/"+a.selectData.prov_id+"/"+a.datakab[t].kab_id,(function(e){$.unblockUI({}),e.success,a.updateEmis(t+1)}))}},a.dosyncEmis=function(){e.datalembaga.length>0?a.syncEmis(0):Swal.fire({type:"error",title:"Syncron",showConfirmButton:!0,html:"Data Lembaga tidak tersedia"})},a.syncLembaga=function(e){$.blockUI({message:"<h4>Harap bersabar...</h4>Sedang Proses Syncron"}),s.get("admin/lembaga/syncemis/"+e,(function(e){$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Syncron",showConfirmButton:!1,html:"Syncron data lembaga berhasil",timer:1e3})):Swal.fire({type:"error",title:"Syncron",showConfirmButton:!0,html:"Rincian data lembaga di emis tidak tersedia"})}))},a.syncEmis=function(t){if(e.datalembaga.length>t){var i=Math.round(100*t/e.datalembaga.length,0);$.blockUI({message:"<h4>Harap bersabar...</h4>Sedang Proses Syncron "+i+"%"}),s.get("admin/lembaga/syncemis/"+e.datalembaga[t].lembaga_nsm,(function(e){$.unblockUI({}),e.success,a.syncEmis(t+1)}))}else a.reloadTable(),Swal.fire({type:"success",title:"Syncron",showConfirmButton:!1,html:"Syncron data lembaga dengan emis selesai",timer:1e3})},a.reloadTable=function(){localStorage.setItem("selectData",JSON.stringify(a.selectData)),e.readKec(),e.datalembaga={},""!==a.selectData.kab_id&&(a.filteredArray=e.datakab.filter((function(e){return e.kab_id==a.selectData.kab_id})),a.filteredArray.length>0&&(a.kab_nama=a.filteredArray[0].kab_nama),$(".table-responsive").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),s.post("admin/lembaga/data",a.selectData,(function(a){$(".table-responsive").unblock({}),e.datalembaga=a.data})))},a.editKodeMadrasah=function(e){console.log(e),Swal.fire({title:"Edit Kode Lembaga!",text:"Masukkan 3 digit Kode Lembaga "+e.lembaga_nama+":",input:"text",inputValue:e.lembaga_kode,showCancelButton:!0}).then((t=>{console.log(t),t.value&&($.blockUI({message:"<h4>Harap bersabar...</h4>Sedang Proses Syncron"}),s.post("admin/lembaga/setkode",{lembaga_kode:t.value,lembaga_id:e.lembaga_id},(function(e){$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Simpan",showConfirmButton:!1,html:"Kode madrasah berhasil disimpan",timer:1e3})):Swal.fire({type:"error",title:"Simpan",showConfirmButton:!0,html:e.message})})))}))},a.dodataUpload=function(){""==a.selectData.prov_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih provinsi terlebih dahulu",timer:1e3}):(a.dataEdit={},a.dataEdit.kelas_id=a.selectData.prov_id,a.dataEdit.tingkat_id=a.selectData.kab_id,a.dataEdit.edit=!1,$(".upload-modal").modal("show"))},a.dodataEdit=function(t){a.dataEdit=t,a.dataEdit.edit=!0,e.datakec2=e.arrPush(e.datakec),$(".edit-modal").modal("show")},a.tambahLembaga=function(){""==a.selectData.prov_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih provinsi terlebih dahulu",timer:1e3}):""==a.selectData.kab_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih kabupaten terlebih dahulu",timer:1e3}):(a.dataEdit={},a.dataEdit.provinsi_id=a.selectData.prov_id,a.dataEdit.kota_id=a.selectData.kab_id,a.dataEdit.jenjang_id="",a.dataEdit.lembaga_nama="",a.dataEdit.lembaga_status="",a.dataEdit.edit=!1,e.datakec2=e.arrPush(e.datakec),$(".edit-modal").modal("show"))},e.autoName=function(){if(a.dataEdit.lembaga_nama.length<5){var e="";if("2"==a.dataEdit.jenjang_id)e="MI";else if("3"==a.dataEdit.jenjang_id)e="MTs";else if("4"==a.dataEdit.jenjang_id)e="MA";var t="";if("1"==a.dataEdit.lembaga_status)t="N ";else if("2"==a.dataEdit.lembaga_status)t="S ";""!==e&&""!==t&&(a.dataEdit.lembaga_nama=e+t)}},e.readKec=function(){e.datakec=[],""!==a.selectData.kab_id&&s.post("admin/admin/kec",{kab_id:a.selectData.kab_id},(function(a){e.datakec=a.data}))},e.readKec2=function(t){$("#kecamatan").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),e.datakec2=[],""!==t?s.post("admin/admin/kec",{kab_id:t},(function(t){a.dataEdit.kecamatan_id="",e.datakec2=t.data;try{e.$apply()}catch(a){}$("#kecamatan").unblock()})):$("#kecamatan").unblock()},e.readKab=function(){$("#kabupaten").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),a.selectData.kab_id="",e.datakab=[],""!==a.selectData.prov_id?s.post("admin/admin/kab",{prov_id:a.selectData.prov_id},(function(t){e.datakab=t.data,1==e.datakab.length&&(a.selectData.kab_id=e.datakab[0].kab_id,a.reloadTable()),$("#kabupaten").unblock()})):$("#kabupaten").unblock()},e.doGenKode=function(){$.blockUI({message:"<h4>Harap bersabar...</h4>Sedang Proses Generate"}),""!==a.selectData.jenjang_id?s.post("admin/lembaga/genkode",a.selectData,(function(e){$.unblockUI(),a.reloadTable()})):$.unblockUI()},a.resetToken=function(e){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Reset!",allowOutsideClick:!1,allowEscapeKey:!1,showCancelButton:!0,html:"Apakah Anda yakin akan mereset Token Lembaga ini?"}).then((t=>{console.log(t),t.value&&($.blockUI({}),s.post("admin/lembaga/resettoken",{lembaga_id:e},(function(e){console.log(e),$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Reset",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:e.message,timer:1e3})})))}))},a.deleteLembaga=function(e){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",allowOutsideClick:!1,allowEscapeKey:!1,showCancelButton:!0,html:"Apakah Anda yakin akan menghapus Lembaga ini?"}).then((t=>{console.log(t),t.value&&($.blockUI({}),s.post("admin/lembaga/deletelembaga",{lembaga_id:e},(function(e){console.log(e),$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Lembaga berhasil dihapus.",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:e.message,timer:1e3})})))}))},a.dodataDelete=function(e){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((t=>{console.log(t),"cancel"!==t.dismiss&&($.blockUI({}),s.post("admin/lembaga/delete",{lembaga_id:e},(function(e){console.log(e),$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:e.message,timer:1e3})})))}))},a.saveeditlembaga=function(){$(".edit-modal").modal("hide"),$.blockUI({}),s.post("admin/lembaga/save",a.dataEdit,(function(e){console.log(e),$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:e.message,timer:1e3}).then((a=>{a.dismiss===Swal.DismissReason.timer&&$(".edit-modal").modal("show")}))}))},e.newKab=function(){$("#kabupaten").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),""!==a.selectData.prov_id?s.post("admin/admin/kab",{prov_id:a.selectData.prov_id},(function(t){if(e.datakab=t.data,$("#kabupaten").unblock(),void 0!==a.selectData.kab_id&&""!==a.selectData.kab_id){angular.forEach(e.datakab,(function(e,t){if(e.kab_id==a.selectData.kab_id){a.reloadTable()}})),a.selectData.kab_id=""}})):$("#kabupaten").unblock()};try{a.selectData=JSON.parse(localStorage.getItem("selectData")||{})}catch(e){a.selectData={}}if(1==e.masterprov.length)a.selectData.prov_id=e.masterprov[0].prov_id,e.readKab(),"adminkab"==e.userData.status&&a.reloadTable();else if(Object.keys(a.selectData).length>0){null==e.datakab&&e.newKab();try{a.reloadTable()}catch(a){}}else a.selectData.prov_id="",a.selectData.kab_id="";a.$on("ProvChange",(function(t,i){1==i.length&&(a.selectData.prov_id=i[0].prov_id,e.readKab())}));var d=a.uploader=new r({url:base_url+"admin/lembaga/import"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){d.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},d.filters.push({name:"customFilter",fn:function(a,e){return this.queue.length<100}}),d.filters.push({name:"imageFilter",fn:function(a,e){var t="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",t),-1!=="|xls|xlsx|".indexOf(t)}}),d.onSuccessItem=function(e,t,i,n){console.log(i),a.berhasilka=a.berhasilka+t.sukses,a.gandaaa=a.gandaaa+t.double1,a.gagalaa=a.gagalaa+t.gagal,a.hasilupload=t.lembaga,a.$apply(),console.info("onSuccessItem",e,t,i,n,a.gandaaa)},d.onCompleteAll=function(){e.readKab(),a.reloadTable()},d.onBeforeUploadItem=function(e){a.hasilupload={},e.url=base_url+"admin/lembaga/import?prov_id="+a.selectData.prov_id+"&kab_id="+a.selectData.kab_id},d.onAfterAddingAll=function(a){d.uploadAll()}}]);
angular.module("RdmApp").controller("mapelCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(t,e,a,i,n,l,o,s){e.dataEdit={},e.selectData={},e.mastermapel={},e.selectData.jenjang_id="",e.selectData.mapel_induk=0,t.readMapel=function(){$(".table-responsive").block({}),s.post("admin/mapel/data",e.selectData,(function(t){$(".table-responsive").unblock({}),e.mastermapel=t.data,e.indukmapel=t.induk,e.jurusanmapel=t.jurusan}))},t.mapelTambah=function(){""!==e.selectData.jenjang_id?(e.dataEdit={},e.dataEdit.jenjang_id=e.selectData.jenjang_id,e.selectData.mapel_induk=0,$(".edit-modal").modal("show")):Swal.fire({type:"error",title:"Perhatian",showConfirmButton:!1,html:"Silahkan pilih jenjang terlebih dahulu",timer:1500})},t.savedataEdit=function(){$(".edit-modal").modal("hide"),$.blockUI({}),s.post("admin/mapel/save",e.dataEdit,(function(e){console.log(e),$.unblockUI({}),e.success?(t.readMapel(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:e.message,timer:1e3}).then((t=>{t.dismiss===Swal.DismissReason.timer&&$(".edit-modal").modal("show")}))}))},t.dodataDelete=function(e){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((a=>{console.log(a),"cancel"!==a.dismiss&&($.blockUI({}),s.post("admin/mapel/delete",{mapel_id:e},(function(e){console.log(e),$.unblockUI({}),e.success?(t.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:e.message,timer:1e3})})))}))},t.dodataEdit=function(t){e.dataEdit=t,console.log(e.dataEdit),$(".edit-modal").modal("show")},t.dtOptions=i.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(t){e.customepdf(t,"Absen Siswa","Elearning")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("paging",!0).withOption("stateSave",!0).withPaginationType("full_numbers")}]);
angular.module("RdmApp").controller("pelaksanaCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$compile",function(a,t,e,n,i,l,o,s,r,d){a.dtInstance={},a.dtInstance2={},a.tabelData=[],a.currPg=0,a.currPg1=0,a.dtColumns=[i.newColumn("no").withTitle("#").notSortable(),i.newColumn("lembaga_nsm").withTitle("NSM"),i.newColumn("lembaga_nama").withTitle("Nama Lembaga"),i.newColumn("jenjang_nama").withTitle("Jenjang"),i.newColumn("moda_pelaksanaan").withTitle("Moda").notSortable(),i.newColumn("status_pelaksanaan").withTitle("Status").notSortable(),i.newColumn("total_siswa").withTitle("Siswa").notSortable(),i.newColumn("tidak_lengkap").withTitle("Belum Lengkap").notSortable(),i.newColumn(null).withTitle("Aksi").notSortable().renderWith((function(a,e,n,i){var l='<div class="btn-group m-1" role="group" aria-label="Basic example"><button class="btn btn-sm btn-success" type="button" ng-click="dodataEdit('+i.row+')"> <i class="c-icon fa fa-edit"></i> <span class="d-md-down-none">Edit</span> </button>';t.masterprov.length>1&&(l+='<button class="btn btn-sm btn-danger" type="button" ng-click="dodataDelete('+i.row+')"> <i class="c-icon fa fa-trash"></i> <span class="d-md-down-none">Hapus</span> </button>');""!==a.registrasi_password&&(l+='<button class="btn btn-sm btn-primary" type="button" ng-click="dodataReset('+i.row+')"> <i class="c-icon fa fa-refresh"></i> <span class="d-md-down-none">Reset</span> </button>');return l+="</div>"}))],a.dtOptions=n.newOptions().withOption("ajax",(function(t,e,n){console.log(t),$(".table-responsive").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),void 0!==a.selectData.prov_id?(t.prov_id=a.selectData.prov_id,t.kab_id=a.selectData.kab_id,t.jenjang_id=a.selectData.jenjang_id,s.post("admin/lembaga/dataaktif",t,(function(t){$(".table-responsive").unblock({}),console.log(t),a.tabelData=t.results.data,e({recordsTotal:t.results.recordsTotal,recordsFiltered:t.results.recordsFiltered,data:t.results.data})}))):($(".table-responsive").unblock({}),e({recordsTotal:0,recordsFiltered:0,data:{}}))})).withOption("language",{paginate:{first:"<i class='fa fa-fast-backward'></i>",previous:"<i class='fa fa-step-backward'></i>",next:"<i class='fa fa-step-forward'></i>",last:"<i class='fa fa-fast-forward'></i>|"}}).withDataProp("data").withDOM("lBfrtip").withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> PDF',download:"open",exportOptions:{columns:[0,1,2,3,4,5,6]},titleAttr:"Print",customize:function(a){t.customepdf(a,"Data Lembaga","Pangkalan Data AKMI")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,1,2,3,4,5,6]},titleAttr:"Excel"}]).withOption("drawCallback",(function(t){if(a.currPg=0,t.aoData.length>0){var e=this.api().page.info();console.log(e),a.currPg=e}})).withOption("columnDefs",[{responsivePriority:1,targets:0},{responsivePriority:2,targets:-1}]).withOption("responsive",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withOption("serverSide",!0).withOption("aaSorting",[0,"asc"]).withOption("createdRow",(function(t){d(angular.element(t).contents())(a)})).withPaginationType("full_numbers"),a.dtOptions2=n.newOptions().withOption("searching",!0).withOption("drawCallback",(function(t){if(a.currPg2=0,t.aoData.length>0){var e=this.api().page.info();console.log(e),a.currPg2=e}})).withOption("responsive",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("paging",!0).withOption("stateSave",!0).withOption("processing",!0).withPaginationType("full_numbers"),a.syncLembaga=function(t){$.blockUI({message:"<h4>Harap bersabar...</h4>Sedang Proses Syncron"}),s.get("admin/lembaga/syncemis/"+t,(function(t){$.unblockUI({}),t.success?(a.reloadTable(),Swal.fire({type:"success",title:"Syncron",showConfirmButton:!1,html:"Syncron data lembaga berhasil",timer:1e3})):Swal.fire({type:"error",title:"Syncron",showConfirmButton:!0,html:"Rincian data lembaga di emis tidak tersedia"})}))},t.datalembaga={},a.reloadTable=function(){localStorage.setItem("selectData",JSON.stringify(a.selectData)),$("#aktifTable").DataTable().ajax.reload()},a.dodataEdit=function(e){a.dataEdit=t.arrPush(a.tabelData[e]),$(".edit-moda").modal("show")},t.autoName=function(){if(a.dataEdit.lembaga_nama.length<5){var t="";if("2"==a.dataEdit.jenjang_id)t="MI";else if("3"==a.dataEdit.jenjang_id)t="MTs";else if("4"==a.dataEdit.jenjang_id)t="MA";var e="";if("1"==a.dataEdit.lembaga_status)e="N ";else if("2"==a.dataEdit.lembaga_status)e="S ";""!==t&&""!==e&&(a.dataEdit.lembaga_nama=t+e)}},t.readKec=function(a){t.datakec=[],""!==a&&($("#selectKecamatan").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),s.post("admin/admin/kec",{kab_id:a},(function(a){t.datakec=a.data,$("#selectKecamatan").unblock()})))},t.readKab=function(){a.reloadTable(),t.newreadKab()},t.newreadKab=function(){$("#kabupaten").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),a.selectData.kab_id="",t.datakab=[],""!==a.selectData.prov_id?s.post("admin/admin/kab",{prov_id:a.selectData.prov_id},(function(e){t.datakab=e.data,1==t.datakab.length&&(a.selectData.kab_id=t.datakab[0].kab_id,a.updateTable()),$("#kabupaten").unblock()})):$("#kabupaten").unblock()},a.$on("ProvChange",(function(e,n){1==n.length&&(a.selectData.prov_id=n[0].prov_id,t.newKab())})),a.dodataDelete=function(t){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus lembaga ini dari pelaksanaan AKMI?"}).then((e=>{console.log(e),"cancel"!==e.dismiss&&($.blockUI({}),s.post("admin/lembaga/deletepelaksana",a.tabelData[t],(function(t){console.log(t),$.unblockUI({}),t.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:t.message,timer:1e3})})))}))},a.dodataReset=function(t){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, reset!",showCancelButton:!0,html:"Apakah Anda yakin akan mereset password akses madrasah?"}).then((e=>{console.log(e),"cancel"!==e.dismiss&&($.blockUI({}),s.post("admin/lembaga/resetpass",a.tabelData[t],(function(t){console.log(t),$.unblockUI({}),t.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Password Berhasil Direset",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:t.message,timer:1e3})})))}))},a.savePelaksanaan=function(){$(".edit-moda").modal("hide"),$.blockUI({}),s.post("admin/lembaga/savepelaksana",a.dataEdit,(function(t){console.log(t),$.unblockUI({}),t.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:t.message,timer:1e3}).then((a=>{a.dismiss===Swal.DismissReason.timer&&$(".edit-moda").modal("show")}))}))},a.tambahPelaksana=function(){""==a.selectData.prov_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih provinsi terlebih dahulu",timer:1e3}):""==a.selectData.kab_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih kabupaten terlebih dahulu",timer:1e3}):(a.updateTable(),$(".edit-modal").modal("show"))},a.dotambahPelaksana=function(t){$(".tabel-reload").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),s.post("admin/lembaga/tambahpelaksana",t,(function(t){$(".tabel-reload").unblock({}),t.success?(a.updateTable(),a.reloadTable(),Swal.fire({type:"success",title:"Syncron",showConfirmButton:!1,html:"Lembaga berhasil ditambahkan",timer:1e3})):Swal.fire({type:"error",title:"Syncron",showConfirmButton:!0,html:"Lembaga gagal ditambahkan"})}))},a.updateTable=function(){$(".tabel-reload").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),s.post("admin/lembaga/datanew",a.selectData,(function(a){$(".tabel-reload").unblock({}),t.selectdatalembaga=a.data}))},a.dodataUpload=function(){$(".upload-modal").modal("show")},t.newKab=function(){$("#kabupaten").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),""!==a.selectData.prov_id?s.post("admin/admin/kab",{prov_id:a.selectData.prov_id},(function(e){if(t.datakab=e.data,1==t.datakab.length)a.selectData.kab_id=t.datakab[0].kab_id,a.updateTable();else if(void 0!==a.selectData.kab_id&&""!==a.selectData.kab_id){angular.forEach(t.datakab,(function(t,e){if(t.kab_id==a.selectData.kab_id){a.updateTable()}})),a.selectData.kab_id=""}$("#kabupaten").unblock()})):$("#kabupaten").unblock()};try{a.selectData=JSON.parse(localStorage.getItem("selectData")||{})}catch(t){a.selectData={}}1==t.masterprov.length?(a.selectData.prov_id=t.masterprov[0].prov_id,t.newKab()):Object.keys(a.selectData).length>0&&null==t.datakab&&t.newKab();var c=a.uploader=new r({url:base_url+"admin/lembaga/importpelaksana"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){c.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},c.filters.push({name:"customFilter",fn:function(a,t){return this.queue.length<100}}),c.filters.push({name:"imageFilter",fn:function(a,t){var e="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",e),-1!=="|xls|xlsx|".indexOf(e)}}),c.onSuccessItem=function(t,e,n,i){console.log(n),a.berhasilka=a.berhasilka+e.sukses,a.gandaaa=a.gandaaa+e.double1,a.gagalaa=a.gagalaa+e.gagal,a.hasilupload=e.lembaga,a.$apply(),console.info("onSuccessItem",t,e,n,i,a.gandaaa)},c.onCompleteAll=function(){t.readKab(),a.reloadTable()},c.onBeforeUploadItem=function(t){a.hasilupload={},t.url=base_url+"admin/lembaga/importpelaksana"},c.onAfterAddingAll=function(a){c.uploadAll()}}]);
angular.module("RdmApp").controller("pengaturanCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(e,t,a,i,n,o,l,d,r){e.mergerData={},e.currPg=0,t.dataTimeline={},e.reloadTable=function(){$(".table-responsive").block({}),d.get("admin/pengaturan/timeline",(function(e){$(".table-responsive").unblock({}),t.dataTimeline=e.data}))},e.reloadTable(),e.tambahTimeline=function(t){e.dataEdit={},e.dataEdit.edit=!1,e.dataEdit.timeline_judul="",e.dataEdit.timeline_isi="",e.dataEdit.timeline_status="1",$(".edit-modal").modal("show")},e.dodataEdit=function(a){e.dataEdit=t.arrPush(a),e.dataEdit.edit=!0;try{e.$apply()}catch(e){}$(".edit-modal").modal("show")},t.updatedataprov=function(){$.blockUI({}),d.get("admin/prov",(function(e){$.unblockUI({}),t.masterprov=e.data}))},e.updatePengaturan=function(t){$(".edit-modal").modal("hide"),$.blockUI({}),d.post("admin/pengaturan/saveatur",t,(function(t){$.unblockUI({}),t.success?(e.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:t.message,timer:1e3}).then((e=>{e.dismiss===Swal.DismissReason.timer&&$(".edit-modal").modal("show")}))}))},e.dodataDelete=function(t){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((a=>{console.log(a),"cancel"!==a.dismiss&&($.blockUI({}),d.post("admin/pengaturan/timelinedelete",{timeline_id:t},(function(t){console.log(t),$.unblockUI({}),t.success?(e.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:t.message,timer:1e3})})))}))}}]);
angular.module("RdmApp").controller("provinsiCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(t,a,e,i,o,r,n,s,l){t.dtInstance={},t.mergerData={},t.selectData={},t.selectData.prov_id="",t.currPg=0,t.dtOptions=i.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(t){a.customepdf(t,"Data Provinsi","Pangkalan Data AKMI")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("drawCallback",(function(a){if(t.currPg=0,a.aoData.length>0){var e=this.api().page.info();console.log(e),t.currPg=e.start}})).withOption("columnDefs",[{responsivePriority:1,targets:0},{responsivePriority:2,targets:-1}]).withOption("language",{paginate:{first:"<i class='fa fa-fast-backward'></i>",previous:"<i class='fa fa-step-backward'></i>",next:"<i class='fa fa-step-forward'></i>",last:"<i class='fa fa-fast-forward'></i>|"}}).withDOM("lBfrtip").withOption("responsive",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withOption("aaSorting",[0,"asc"]).withPaginationType("full_numbers"),a.datalembaga={},t.reloadTable=function(){a.datalembaga={},""!==t.selectData.kelas_id&&($.blockUI({}),s.post("admin/lembaga/data",t.selectData,(function(t){$.unblockUI({}),a.datalembaga=t.data})))},t.dodataEdit=function(e){t.dataEdit=a.arrPush(e),t.dataEdit.edit=!0;try{t.$apply()}catch(t){}$(".edit-modal").modal("show")},a.updatedataprov=function(){$.blockUI({}),s.get("admin/prov",(function(t){$.unblockUI({}),a.masterprov=t.data}))},t.saveeditprov=function(){$(".edit-modal").modal("hide"),$.blockUI({}),s.post("admin/provinsi/save",t.dataEdit,(function(t){$.unblockUI({}),t.success?(a.updatedataprov(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:t.message,timer:1e3}).then((t=>{t.dismiss===Swal.DismissReason.timer&&$(".edit-modal").modal("show")}))}))},t.processMerger=function(){""!==t.mergerData.tujuankab_id?($(".merger-modal").modal("hide"),$.blockUI({}),s.post("admin/kabupaten/merger",t.mergerData,(function(t){$.unblockUI({}),t.success?(a.readKab(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dimerger",timer:1e3})):($(".merger-modal").modal("show"),Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:t.message,timer:1e3}))}))):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:"Tujuan merger belum di pilih",timer:1e3})},t.dodataMerger=function(a){t.mergerData=a,t.mergerData.tujuankab_id="",$(".merger-modal").modal("show")}}]);
angular.module("RdmApp").controller("rekapCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(t,a,e,i,n,o,l,s,r){t.dtInstance={},t.currPg=0,console.log(a.userData),t.dtOptions=i.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(t){a.customepdf(t,"Data Kabupaten","Pangkalan Data AKMI")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("drawCallback",(function(a){if(t.currPg=0,a.aoData.length>0){var e=this.api().page.info();console.log(e),t.currPg=e.start}})).withOption("language",{paginate:{first:"<i class='fa fa-fast-backward'></i>",previous:"<i class='fa fa-step-backward'></i>",next:"<i class='fa fa-step-forward'></i>",last:"<i class='fa fa-fast-forward'></i>|"}}).withDOM("lBfrtip").withOption("responsive",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withOption("aaSorting",[0,"asc"]).withPaginationType("full_numbers"),t.reloadTable=function(){console.log(a.datarekap.length),null!=a.datarekap.length&&0!=a.datarekap.length||$(".table-responsive").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),s.get("admin/rekap/data",(function(t){$.unblockUI({}),$(".table-responsive").unblock({}),a.datarekap={},a.datarekap=t.data}))},t.reloadTable()}]);
angular.module("RdmApp").controller("suspendlembagaCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(e,t,a,n,o,i,l,s,r){e.dtInstance={},e.selectData={},e.selectData.prov_id="",e.currPg=0,e.dtOptions=n.newOptions().withOption("searching",!0).withOption("stateSave",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> PDF',download:"open",orientation:"landscape",exportOptions:{columns:[0,1,2,3,4,5,6,7]},titleAttr:"Print",customize:function(e){t.customepdf(e,"Lembaga Suspend","Pangkalan Data AKMI")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,1,2,3,4,5,6,7]},titleAttr:"Excel"}]).withOption("drawCallback",(function(t){if(e.currPg=0,t.aoData.length>0){var a=this.api().page.info();console.log(a),e.currPg=a.start}})).withOption("responsive",!0).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withPaginationType("full_numbers"),t.datalembaga={},e.reloadTable=function(){$(".table-responsive").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),s.post("admin/suspendlembaga/data",e.selectData,(function(e){$(".table-responsive").unblock({}),t.datalembaga=e.data}))},e.reloadTable(),e.allowext="",e.filekey="",e.tipefile=function(t){e.filekey=t,e.allowext=t.split(".").pop()},e.dodataEdit=function(t){e.dataEdit=t,e.dataEdit.edit=!0,$(".edit-modal").modal("show")},e.dodataDelete=function(t){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((a=>{console.log(a),"cancel"!==a.dismiss&&($.blockUI({}),s.post("admin/filemanagemen/delete",t,(function(t){console.log(t),$.unblockUI({}),t.success?(e.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:t.message,timer:1e3})})))}))};var u=e.uploader=new r({url:base_url+"admin/filemanagemen/upload"});e.hapussemua=function(){u.clearQueue()},u.filters.push({name:"customFilter",fn:function(e,t){return this.queue.length<100}}),u.filters.push({name:"imageFilter",fn:function(t,a){var n="|"+t.name.substr(t.name.lastIndexOf(".")+1)+"|";return console.info("type",n),"|"+e.allowext+"|".indexOf(n)!==-1}}),u.onSuccessItem=function(t,a,n,o){console.log(n),console.info("onSuccessItem",t,a,n,o,e.gandaaa)},u.onCompleteAll=function(){$(".upload-modal").modal("hide"),e.hapussemua(),e.reloadTable()},u.onBeforeUploadItem=function(t){e.hasilupload={},t.url=base_url+"admin/filemanagemen/upload?key="+e.filekey},u.onAfterAddingAll=function(e){u.uploadAll()}}]);
angular.module("RdmApp").controller("timelineCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(t,i,e,a,n,o,l,s,r){t.dtInstance={},t.mergerData={},t.selectData={},t.selectData.prov_id="",t.currPg=0,t.dtOptions=a.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(t){i.customepdf(t,"Data Provinsi","Pangkalan Data AKMI")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("drawCallback",(function(i){if(t.currPg=0,i.aoData.length>0){var e=this.api().page.info();console.log(e),t.currPg=e.start}})).withOption("columnDefs",[{responsivePriority:1,targets:0},{responsivePriority:2,targets:-1}]).withOption("language",{paginate:{first:"<i class='fa fa-fast-backward'></i>",previous:"<i class='fa fa-step-backward'></i>",next:"<i class='fa fa-step-forward'></i>",last:"<i class='fa fa-fast-forward'></i>|"}}).withDOM("lBfrtip").withOption("responsive",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withOption("aaSorting",[0,"asc"]).withPaginationType("full_numbers"),i.dataTimeline={},t.reloadTable=function(){$(".table-responsive").block({}),s.get("admin/pengaturan/timeline",(function(t){$(".table-responsive").unblock({}),i.dataTimeline=t.data}))},t.reloadTable(),t.tambahTimeline=function(i){t.dataEdit={},t.dataEdit.edit=!1,t.dataEdit.timeline_judul="",t.dataEdit.timeline_isi="",t.dataEdit.timeline_status="1",$(".edit-modal").modal("show")},t.dodataEdit=function(e){t.dataEdit=i.arrPush(e),t.dataEdit.edit=!0;try{t.$apply()}catch(t){}$(".edit-modal").modal("show")},i.updatedataprov=function(){$.blockUI({}),s.get("admin/prov",(function(t){$.unblockUI({}),i.masterprov=t.data}))},t.saveeditprov=function(){$(".edit-modal").modal("hide"),$.blockUI({}),s.post("admin/pengaturan/timelinesave",t.dataEdit,(function(i){$.unblockUI({}),i.success?(t.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:i.message,timer:1e3}).then((t=>{t.dismiss===Swal.DismissReason.timer&&$(".edit-modal").modal("show")}))}))},t.dodataDelete=function(i){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((e=>{console.log(e),"cancel"!==e.dismiss&&($.blockUI({}),s.post("admin/pengaturan/timelinedelete",{timeline_id:i},(function(i){console.log(i),$.unblockUI({}),i.success?(t.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:i.message,timer:1e3})})))}))}}]);
angular.module("RdmApp").controller("usernadrasahCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$compile",function(a,e,t,i,n,s,l,o,r,c){a.dtInstance={},a.dtInstance2={},a.tabelData=[],a.currPg=0,a.currPg1=0,a.dtColumns=[n.newColumn("no").withTitle("#").notSortable(),n.newColumn("siswa_nopes").withTitle("Nomor Peserta"),n.newColumn("siswa_nisn").withTitle("NISN"),n.newColumn("siswa_nama").withTitle("Nama"),n.newColumn("siswa_tempat").withTitle("Tempat Lahir"),n.newColumn("siswa_tgllahir").withTitle("Tanggal Lahir"),n.newColumn("tingkat_id").withTitle("Tingkat").notSortable(),n.newColumn(null).withTitle("Aksi").notSortable().renderWith((function(a,e,t,i){return""}))],a.dtOptions=i.newOptions().withOption("ajax",(function(e,t,i){console.log(e),$(".table-responsive").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),void 0!==a.selectData.lembaga_id&&""!==a.selectData.lembaga_id?(e.lembaga_id=a.selectData.lembaga_id,o.post("admin/siswa/data",e,(function(e){$(".table-responsive").unblock({}),a.tabelData=e.results.data,t({recordsTotal:e.results.recordsTotal,recordsFiltered:e.results.recordsFiltered,data:e.results.data})}))):($(".table-responsive").unblock({}),t({recordsTotal:0,recordsFiltered:0,data:{}}))})).withDataProp("data").withDOM("lBfrtip").withOption("language",{paginate:{first:"<i class='fa fa-fast-backward'></i>",previous:"<i class='fa fa-step-backward'></i>",next:"<i class='fa fa-step-forward'></i>",last:"<i class='fa fa-fast-forward'></i>|"}}).withOption("searching",!0).withOption("stateSave",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> PDF',download:"open",orientation:"landscape",pageSize:"A4",exportOptions:{columns:":visible",search:"applied",order:"applied"},titleAttr:"Print",customize:function(a){e.customepdf(a,"Data Lembaga","Pangkalan Data AKMI")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,1,2,3,4,5,6,7]},titleAttr:"Excel"}]).withOption("drawCallback",(function(e){if(a.currPg=0,e.aoData.length>0){var t=this.api().page.info();console.log(t),a.currPg=t}})).withOption("responsive",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withOption("serverSide",!0).withOption("aaSorting",[0,"asc"]).withOption("createdRow",(function(e){c(angular.element(e).contents())(a)})).withPaginationType("simple_numbers"),a.dtOptions2=i.newOptions().withOption("searching",!0).withOption("drawCallback",(function(e){if(a.currPg2=0,e.aoData.length>0){var t=this.api().page.info();console.log(t),a.currPg2=t}})).withOption("responsive",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("paging",!0).withOption("stateSave",!0).withOption("processing",!0).withPaginationType("full_numbers"),e.doGenNopes=function(){$.blockUI({message:"<h4>Harap bersabar...</h4>Sedang Proses Generate"}),""!==a.selectData.jenjang_id?o.post("admin/siswa/gennopes",a.selectData,(function(e){$.unblockUI(),e.success?a.reloadTable():Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})})):$.unblockUI()},a.doSyncEmis=function(){$.blockUI({message:"<h4>Chek tahun ajaran</h4>"}),o.get("admin/siswa/chekTaEmis",(function(e){if($.unblockUI(),e.success){var t=e.Emis.id;a.newsync=0,a.processSyncSiswa(1,t)}else Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))},a.newsync=0,a.processSyncSiswa=function(e,t){$.blockUI({message:"<h4>Syncron Data Emis Halaman "+e+"</h4>"}),o.post("admin/siswa/syncEmis/"+a.selectData.lembaga_id,{page:e,ta:t},(function(e){$.unblockUI(),e.success?(a.newsync+=e.update.length,!1!==e.next?a.processSyncSiswa(e.next,t):(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil Syncron",showConfirmButton:!1,html:a.newsync+" siswa emis berhasil di Syncron",timer:2e3}))):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))},e.dataselectLembaga={},a.reloadData=function(){$("#madrasah").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),a.selectData.lembaga_id="",a.reloadTable(),o.post("admin/lembaga/madrasahaktif",a.selectData,(function(a){$("#madrasah").unblock({}),e.dataselectLembaga=a.data}))},a.reloadTable=function(){localStorage.setItem("selectData",JSON.stringify(a.selectData));try{$("#aktifTable").DataTable().ajax.reload()}catch(a){}},a.dodataEdit=function(t){a.dataEdit=e.arrPush(a.tabelData[t]),$(".edit-moda").modal("show")},e.autoName=function(){if(a.dataEdit.lembaga_nama.length<5){var e="";if("2"==a.dataEdit.jenjang_id)e="MI";else if("3"==a.dataEdit.jenjang_id)e="MTs";else if("4"==a.dataEdit.jenjang_id)e="MA";var t="";if("1"==a.dataEdit.lembaga_status)t="N ";else if("2"==a.dataEdit.lembaga_status)t="S ";""!==e&&""!==t&&(a.dataEdit.lembaga_nama=e+t)}},e.readKec=function(a){e.datakec=[],""!==a&&($("#selectKecamatan").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),o.post("admin/admin/kec",{kab_id:a},(function(a){e.datakec=a.data,$("#selectKecamatan").unblock()})))},e.readKab=function(){e.newreadKab()},e.newreadKab=function(){$("#kabupaten").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),a.selectData.kab_id="",e.datakab=[],""!==a.selectData.prov_id?o.post("admin/admin/kab",{prov_id:a.selectData.prov_id},(function(t){e.datakab=t.data,1==e.datakab.length&&(a.selectData.kab_id=e.datakab[0].kab_id,a.reloadData()),$("#kabupaten").unblock()})):$("#kabupaten").unblock()},a.$on("ProvChange",(function(t,i){1==i.length&&(a.selectData.prov_id=i[0].prov_id,e.newreadKab())})),a.dodataDelete=function(e){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((t=>{console.log(t),"cancel"!==t.dismiss&&($.blockUI({}),o.post("admin/lembaga/delete",{lembaga_id:e},(function(e){console.log(e),$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:e.message,timer:1e3})})))}))},a.savePelaksanaan=function(){$(".edit-moda").modal("hide"),$.blockUI({}),o.post("admin/lembaga/savepelaksana",a.dataEdit,(function(e){console.log(e),$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:e.message,timer:1e3}).then((a=>{a.dismiss===Swal.DismissReason.timer&&$(".edit-moda").modal("show")}))}))},a.tambahPelaksana=function(){""==a.selectData.prov_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih provinsi terlebih dahulu",timer:1e3}):""==a.selectData.kab_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih kabupaten terlebih dahulu",timer:1e3}):(a.updateTable(),$(".edit-modal").modal("show"))},a.dotambahPelaksana=function(e){$(".tabel-reload").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),o.post("admin/lembaga/tambahpelaksana",e,(function(e){$(".tabel-reload").unblock({}),e.success?(a.updateTable(),a.reloadTable(),Swal.fire({type:"success",title:"Syncron",showConfirmButton:!1,html:"Lembaga berhasil ditambahkan",timer:1e3})):Swal.fire({type:"error",title:"Syncron",showConfirmButton:!0,html:"Lembaga gagal ditambahkan"})}))},e.newKab=function(){$("#kabupaten").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),""!==a.selectData.prov_id?o.post("admin/admin/kab",{prov_id:a.selectData.prov_id},(function(t){e.datakab=t.data,$("#kabupaten").unblock(),1==e.datakab.length?(a.selectData.kab_id=e.datakab[0].kab_id,a.reloadData()):void 0!==a.selectData.kab_id&&""!==a.selectData.kab_id&&a.reloadData1()})):$("#kabupaten").unblock()},a.reloadData1=function(){$("#madrasah").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),a.selectData.lembaga_id="",o.post("admin/lembaga/madrasahaktif",a.selectData,(function(a){$("#madrasah").unblock({}),e.dataselectLembaga=a.data}))};try{a.selectData=JSON.parse(localStorage.getItem("selectData")||{})}catch(e){a.selectData={}}1==e.masterprov.length?(a.selectData.prov_id=e.masterprov[0].prov_id,e.newKab()):Object.keys(a.selectData).length>0?(null==e.datakab&&e.newKab(),""!==a.selectData.kab_id&&a.reloadData1()):(a.selectData.prov_id="",a.selectData.kab_id="",a.selectData.lembaga_id="");a.uploader=new r({url:base_url+"admin/lembaga/import"})}]);
